Type.registerNamespace("Telerik.Web.UI");
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(b,a){a.ImageEditor.CommandList={Open:function(d,e,c){d._closeToolsPanelAndSaveCommand(e);
},Undo:function(f,g,e){var d=e&&e.get_item?e.get_item():null;
var c=(!d||d._isDropDownItem()||!d._isDropDownChild())?1:d.get_index()+1;
if(g=="Undo"){f.undo(c);
}else{if(g=="Redo"){f.redo(c);
}}},Reset:function(d,e,c){d.resetChanges();
d._closeToolsPanelAndSaveCommand(e);
},Crop:function(d,e,c){d.executeCommand(e);
},ZoomIn:function(d,e,c){d.zoomIn();
},ZoomOut:function(d,e,c){d.zoomOut();
},FlipVertical:function(d,e,c){d.flipVertical();
},FlipHorizontal:function(d,e,c){d.flipHorizontal();
},RotateRight:function(d,e,c){d.rotateRight90();
},RotateLeft:function(d,e,c){d.rotateLeft90();
}};
a.ImageEditor.CommandList.Redo=a.ImageEditor.CommandList.Undo;
a.ImageEditor.CommandList.Resize=a.ImageEditor.CommandList.Save=a.ImageEditor.CommandList.Print=a.ImageEditor.CommandList.Zoom=a.ImageEditor.CommandList.Opacity=a.ImageEditor.CommandList.Rotate=a.ImageEditor.CommandList.Flip=a.ImageEditor.CommandList.AddText=a.ImageEditor.CommandList.InsertImage=a.ImageEditor.CommandList.Crop;
})($telerik.$,Telerik.Web.UI);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.IImageOperation=function(){};
b.IImageOperation.prototype={execute:function(){},undo:function(){},toString:function(){},fromString:function(d){},fromData:function(d){},canUndo:function(){},get_name:function(){},get_text:function(){},get_image:function(){},dispose:function(){}};
b.IImageOperation.registerInterface("Telerik.Web.UI.ImageEditor.IImageOperation");
b.ImageOperation=function(){this._index=-1;
};
b.ImageOperation.prototype={getIsClientOperation:function(){return true;
},get_index:function(){return this._index;
},set_index:function(d){this._index=d;
}};
b.ImageOperation.registerClass("Telerik.Web.UI.ImageEditor.ImageOperation",null);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.Matrix3x3=function(d){for(var e=0,g=0;
e<3;
e++){for(var f=0;
f<3;
f++,g++){this["m"+(e+1)+(f+1)]=d[g];
}}};
b.Matrix3x3.prototype={m11:1,m12:0,m13:0,m21:0,m22:1,m23:0,m31:0,m32:0,m33:1,multiply:function(d){return new b.Matrix3x3([this.m11*d.m11+this.m12*d.m21+this.m13*d.m31,this.m11*d.m12+this.m12*d.m22+this.m13*d.m32,this.m11*d.m13+this.m12*d.m23+this.m13*d.m33,this.m21*d.m11+this.m22*d.m21+this.m23*d.m31,this.m21*d.m12+this.m22*d.m22+this.m23*d.m32,this.m21*d.m13+this.m22*d.m23+this.m23*d.m33,this.m31*d.m11+this.m32*d.m21+this.m33*d.m31,this.m31*d.m12+this.m32*d.m22+this.m33*d.m32,this.m31*d.m13+this.m32*d.m23+this.m33*d.m33]);
},multiplyVector:function(d){return[this.m11*d[0]+this.m12*d[1]+this.m13,this.m21*d[0]+this.m22*d[1]+this.m23];
},equals:function(d){return this.m11==d.m11&&this.m12==d.m12&&this.m13==d.m13&&this.m21==d.m21&&this.m22==d.m22&&this.m23==d.m23&&this.m31==d.m31&&this.m32==d.m32&&this.m33==d.m33;
},clone:function(){return new b.Matrix3x3([this.m11,this.m12,this.m13,this.m21,this.m22,this.m23,this.m31,this.m32,this.m33]);
}};
b.Matrix3x3.registerClass("Telerik.Web.UI.ImageEditor.Matrix3x3");
b.Matrix3x3.identityMatrix=new b.Matrix3x3([1,0,0,0,1,0,0,0,1]);
b.Matrix3x3.rotate90Matrix=new b.Matrix3x3([0,1,0,-1,0,0,0,0,1]);
b.Matrix3x3.rotate180Matrix=new b.Matrix3x3([-1,0,0,0,-1,0,0,0,1]);
b.Matrix3x3.rotate270Matrix=new b.Matrix3x3([0,-1,0,1,0,0,0,0,1]);
b.Matrix3x3.flipXMatrix=new b.Matrix3x3([-1,0,0,0,1,0,0,0,1]);
b.Matrix3x3.flipYMatrix=new b.Matrix3x3([1,0,0,0,-1,0,0,0,1]);
b.Matrix3x3.getScaleMatrix=function(d){return new b.Matrix3x3([d,0,0,0,d,0,0,0,1]);
};
b.Matrix2x2=function(d){this.m11=d[0];
this.m12=d[1];
this.m21=d[2];
this.m22=d[3];
};
b.Matrix2x2.prototype={m11:1,m12:0,m21:1,m22:0,multiply:function(d){return new b.Matrix2x2([this.m11*d.m11+this.m12*d.m21,this.m11*d.m12+this.m12*d.m22,this.m21*d.m11+this.m22*d.m21,this.m21*d.m12+this.m22*d.m22]);
},multiplyVector:function(d){return[this.m11*d[0]+this.m12*d[1],this.m21*d[0]+this.m22*d[1]];
},equals:function(d){return this.m11==d.m11&&this.m12==d.m12&&this.m21==d.m21&&this.m22==d.m22;
},clone:function(){return new b.Matrix2x2([this.m11,this.m12,this.m21,this.m22]);
}};
b.Matrix2x2.registerClass("Telerik.Web.UI.ImageEditor.Matrix2x2");
b.Matrix2x2.identityMatrix=new b.Matrix2x2([1,0,0,1]);
b.Matrix2x2.rotate90Matrix=new b.Matrix2x2([0,-1,1,0]);
b.Matrix2x2.rotate180Matrix=new b.Matrix2x2([-1,0,0,-1]);
b.Matrix2x2.rotate270Matrix=new b.Matrix2x2([0,1,-1,0]);
b.Matrix2x2.flipXMatrix=new b.Matrix2x2([-1,0,0,1]);
b.Matrix2x2.flipYMatrix=new b.Matrix2x2([1,0,0,-1]);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){c.registerEnum(b,"FlipDirection",{None:0,Vertical:1,Horizontal:2,Both:3});
c.registerEnum(b,"Rotation",{None:0,Rotate90:1,Rotate180:2,Rotate270:3});
c.registerEnum(b,"AllowedSavingLocation",{ClientAndServer:0,Client:1,Server:2});
c.registerEnum(b,"ToolBarMode",{Default:0,Docked:1});
c.registerEnum(b,"ToolBarPosition",{Top:0,Right:1,Bottom:2,Left:3});
b.ImageText=function(){};
c.registerControlProperties(b.ImageText,{fontFamily:"Verdana",fontSize:12,color:"#000000",text:""});
b.ImageText.registerClass("Telerik.Web.UI.ImageEditor.ImageText",null);
b.extendMethod=function(e,g,d){var f=e[g];
e[g]=function(){d.apply(this,arguments);
f.apply(this,arguments);
};
};
b.CancelEventArgs=function(d,e){b.CancelEventArgs.initializeBase(this);
this._domEvent=d;
this._commandName=e;
};
b.CancelEventArgs.prototype={get_commandName:function(){return this._commandName;
},set_commandName:function(d){this._commandName=d;
},get_domEvent:function(){return this._domEvent;
}};
b.CancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.CancelEventArgs",Sys.CancelEventArgs);
b.ImageChangeCancelEventArgs=function(e,g,f,d){b.ImageChangeCancelEventArgs.initializeBase(this,[e,g]);
this._argument=f;
this._updateUI=d;
};
b.ImageChangeCancelEventArgs.prototype={get_argument:function(){return this._argument;
},set_argument:function(d){this._argument=d;
},get_updateUI:function(){return this._updateUI;
},set_updateUI:function(d){this._updateUI=d;
}};
b.ImageChangeCancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ImageChangeCancelEventArgs",b.CancelEventArgs);
b.EventArgs=function(d,e){b.EventArgs.initializeBase(this);
this._domEvent=d;
this._commandName=e;
};
b.EventArgs.prototype={get_commandName:function(){return this._commandName;
},set_commandName:function(d){this._commandName=d;
},get_domEvent:function(){return this._domEvent;
}};
b.EventArgs.registerClass("Telerik.Web.UI.ImageEditor.EventArgs",Sys.EventArgs);
b.ImageChangeEventArgs=function(e,f,d){b.ImageChangeEventArgs.initializeBase(this,[e,f]);
this._operation=d;
};
b.ImageChangeEventArgs.prototype={get_imageOperation:function(){return this._operation;
},set_imageOperation:function(d){this._operation=d;
}};
b.ImageChangeEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ImageChangeEventArgs",b.EventArgs);
b.SavingEventArgs=function(e,d,f){b.SavingEventArgs.initializeBase(this);
this._saveAction=e;
this._fileName=d;
};
b.SavingEventArgs.prototype={get_saveAction:function(){return this._saveAction;
},get_fileName:function(){return this._fileName;
},set_fileName:function(d){this._fileName=d;
},get_overwrite:function(){return true;
}};
b.SavingEventArgs.registerClass("Telerik.Web.UI.ImageEditor.SavingEventArgs",Sys.CancelEventArgs);
b.SavedEventArgs=function(f,d,e,g){b.SavedEventArgs.initializeBase(this);
this._fileName=f;
this._isSaved=d;
this._message=e;
this._argument=g;
};
b.SavedEventArgs.prototype={get_fileName:function(){return this._fileName;
},get_isSaved:function(){return this._isSaved;
},get_argument:function(){return this._argument;
},get_message:function(){return this._message;
}};
b.SavedEventArgs.registerClass("Telerik.Web.UI.ImageEditor.SavedEventArgs",Sys.EventArgs);
b.ShortCutCancelEventArgs=function(e,d){b.ShortCutCancelEventArgs.initializeBase(this);
this._domEvent=e;
this._shortCut=d;
};
b.ShortCutCancelEventArgs.prototype={get_shortCut:function(){return this._shortCut;
},get_domEvent:function(){return this._domEvent;
}};
b.ShortCutCancelEventArgs.registerClass("Telerik.Web.UI.ImageEditor.ShortCutCancelEventArgs",Sys.CancelEventArgs);
b.StatusBar=function(d,e){this._element=d;
this._parentID=e.get_id();
this._imageEditor=e;
this._zoomRatio=null;
this.initialize();
};
b.StatusBar.prototype={initialize:function(){if(!this.get_element()){return;
}var e=this._imageEditor.getEditableImage();
if(e){this.setValue(e.get_zoomLevel(),"zoom");
var d=e.getImage();
if(d){this.updateSize(d.width,d.height);
}this._attachHandlers(true);
}},dispose:function(){if(!this.get_element()){return;
}this._attachHandlers(false);
},_attachHandlers:function(e){var d=this._imageEditor.getEditableImage().getImage();
if(d){if(e){this._mouseMoveDelegate=Function.createDelegate(this,this._mouseMove);
$addHandler(d,"mousemove",this._mouseMoveDelegate);
this._mouseOutDelegate=Function.createDelegate(this,this._mouseOut);
$addHandler(d,"mouseout",this._mouseOutDelegate);
}else{$removeHandler(d,"mousemove",this._mouseMoveDelegate);
this._mouseMoveDelegate=null;
$removeHandler(d,"mouseout",this._mouseOutDelegate);
this._mouseOutDelegate=null;
}}},_mouseMove:function(e){if(this._zoomRatio==null){this._zoomRatio=100/this._imageEditor.getEditableImage().get_zoomLevel();
this._viewPort=this._imageEditor.get_viewport();
}var d=this._getMousePos(e.rawEvent);
var f=this._imageEditor.get_left();
var g=this._imageEditor.get_top();
if($telerik.isSafari){f-=1;
g-=1;
}if($telerik.isIE6||$telerik.isIE7){f+=2;
g+=2;
}this.updatePosition(Math.floor((d.x-f+this._viewPort.scrollLeft)*this._zoomRatio),Math.floor((d.y-g+this._viewPort.scrollTop)*this._zoomRatio));
},_getMousePos:function(g){var f=0;
var d=0;
if(g.pageX||g.pageY){f=g.pageX;
d=g.pageY;
}else{if(g.clientX||g.clientY){f=g.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;
d=g.clientY+document.body.scrollTop+document.documentElement.scrollTop;
}}return{x:f,y:d};
},_mouseOut:function(d){this.updatePosition("-","-");
this._zoomRatio=null;
},get_element:function(){return this._element;
},get_coorX:function(){if(!this._X){this._X=this._getChildElement("sbX");
}return this._X;
},get_coorY:function(){if(!this._Y){this._Y=this._getChildElement("sbY");
}return this._Y;
},get_zoom:function(){if(!this._zoom){this._zoom=this._getChildElement("sbZoom");
}return this._zoom;
},get_width:function(){if(!this._width){this._width=this._getChildElement("sbW");
}return this._width;
},get_height:function(){if(!this._height){this._height=this._getChildElement("sbH");
}return this._height;
},get_lastAction:function(){if(!this._lastAction){this._lastAction=this._getChildElement("sbAction");
}return this._lastAction;
},setValue:function(d,e){var f=this["get_"+e]();
if(f){f.innerHTML=d;
}if(d&&d.indexOf&&d.indexOf("Resize")!=-1){this._updateSizeInternal();
}},_updateSizeInternal:function(){var d=this._imageEditor.getEditableImage();
if(d){this.setValue(d.get_width(),"width");
this.setValue(d.get_height(),"height");
}},updateSize:function(d,e){if(typeof(d)=="undefined"||d==null||e==null||typeof(e)=="undefined"){this._updateSizeInternal();
return;
}this.setValue(d,"width");
this.setValue(e,"height");
},updatePosition:function(d,e){this.setValue(d,"coorX");
this.setValue(e,"coorY");
},_getChildElement:function(d){return $get(this._parentID+"_"+d,this.get_element());
}};
b.StatusBar.registerClass("Telerik.Web.UI.ImageEditor.StatusBar",null);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.EditableImage=function(e,d,f){this._image=e;
this._xmlHttpPanel=d;
this._imageEditor=f;
this.initialize();
};
b.EditableImage.prototype={initialize:function(){this._width=null;
this._height=null;
this._opacity=null;
this._flipH=false;
this._flipV=false;
this._rotationAngle=null;
this._zoomLevel=100;
this._viewMatrix=b.Matrix3x3.identityMatrix.clone();
this._reloadEventCallbacks=[];
this._customInitialize();
this._attachToImageLoad(true);
this._setOriginalSwapImageOperation();
},_customInitialize:function(){if($telerik.isIE&&!$telerik.isIE9Mode){this._image.style.filter="flipH flipV progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=100) progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingmethod='auto expand')";
this._image.filters.item("flipH").enabled=0;
this._image.filters.item("flipV").enabled=0;
}},changeOpacity:function(e,d){if(!d){d=new b.OpacityOperation(this,e,this.get_opacity());
}return this._applyOperation(d);
},resize:function(e,d,g){if(!g){g=new b.ResizeOperation(this,e,d);
}var f=this._applyOperation(g);
this._isResized=false;
return f;
},rotate:function(d,f,e){if(!e){e=new b.RotateOperation(this,d,f);
}return this._applyOperation(e);
},flip:function(d,e,f){if(!f){f=new b.FlipOperation(this,d,e);
}return this._applyOperation(f);
},crop:function(e){var d=new b.CropOperation(this,"",e);
this._doServerOperation(c.extend({name:"Crop",key:this.get_imageKey()},e),Function.emptyFunction,d);
return d;
},addText:function(f,g,d){var e=new b.AddTextOperation(this,"");
this._doServerOperation({name:"AddText",key:this.get_imageKey(),x:f,y:g,text:d.get_text(),font:d.get_fontFamily(),color:d.get_color(),size:d.get_fontSize()},null,e);
return e;
},insertImage:function(g,h,d,f){var e=new b.InsertImageOperation(this,"");
if(!f){f=[];
}this._doServerOperation({name:"InsertImage",key:this.get_imageKey(),value:d,arrayOps:this._imageEditor._operationSerializer.serializeOperationStack(f),x:g,y:h},null,e);
return e;
},reset:function(e){var f=this._getOriginalSwapImageOperation();
var d=c(this.getImage());
d.data("key",undefined);
d.attr("src","");
this._resetCSS();
this._doServerOperation({name:"Reset"},Function.createDelegate(this,this._finishReset),f);
},_finishReset:function(){this._width=null;
this._height=null;
this._applySize("","");
},_resetCSS:function(){this._flipV=false;
this._flipH=false;
this._rotationAngle=0;
this._opacity=100;
this._width=null;
this._height=null;
this._zoomLevel=100;
this._applySize("","");
this._changeOpacity();
this._flip();
this._rotate();
},zoomBestFit:function(f,d){var g=f/this.get_width();
var h=d/this.get_height();
var e=g>h?h:g;
if(e<1){this.zoom(Math.floor(e*100)-1);
}else{this.zoom(100);
}},zoom:function(f,d){f=(f==null||typeof(f)=="undefined")?this.get_zoomLevel():f;
if(!d&&f==this._zoomLevel){return;
}this._zoomLevel=f;
var h=f/100;
var g=this._getWidth()*h;
var e=this._getHeight()*h;
this._updateTransformOrigin(this.getImage(),this.get_rotationAngle(),g,e);
this._applySize(g,e);
},getImage:function(){return this._image;
},_applyOperation:function(d){d.execute();
return d;
},get_zoomLevel:function(){return this._zoomLevel;
},get_width:function(){if(this._getIsHorizontal()){return this._getWidth();
}else{return this._getHeight();
}},_getWidth:function(){if(this._width==null){var e=this.getImage();
var d=e.style.OTransform;
if($telerik.isOpera&&(d.indexOf("90deg")!=-1||d.indexOf("270deg")!=-1)){this._width=e.height;
}else{this._width=e.width;
}}return this._width;
},get_height:function(){if(this._getIsHorizontal()){return this._getHeight();
}else{return this._getWidth();
}},_getHeight:function(){if(this._height==null){var e=this.getImage();
var d=e.style.OTransform;
if($telerik.isOpera&&(d.indexOf("90deg")!=-1||d.indexOf("270deg")!=-1)){this._height=e.width;
}else{this._height=e.height;
}}return this._height;
},get_opacity:function(){if(this._opacity==null){var f=this.getImage();
var d=($telerik.isIE9Mode)?null:f.filters;
if(d){var e=d.item("DXImageTransform.Microsoft.Alpha");
if(e){this._opacity=e.opacity;
}}else{this._opacity=(f.style.opacity==""||f.style.MozOpacity=="")?100:parseInt((f.style.opacity||f.style.MozOpacity)*100);
}}return this._opacity;
},get_flipDirection:function(){var e=this._getIsHorizontal();
var d=e?this._flipH:this._flipV;
var f=e?this._flipV:this._flipH;
return this._getFlipDirection(d,f);
},_getAbsFlipDirection:function(){return this._getFlipDirection(this._flipH,this._flipV);
},get_rotationAngle:function(){if(this._rotationAngle==null){var g=($telerik.isIE9Mode)?null:this.getImage().filters;
if(g){var e=g.item("DXImageTransform.Microsoft.Matrix");
if(e){var h=Math.acos(e.M11);
var i=Math.round((h*360)/(2*Math.PI));
var j=Math.round((Math.asin(e.M21)*360)/(2*Math.PI));
i=j==-90?270:i;
this._rotationAngle=i;
}}else{var d=this.getImage().style.transform;
var f=(d&&d.indexOf("rotate")!=-1)?parseInt(d.substring(d.indexOf("rotate(")+7,d.indexOf("deg"))):0;
this._rotationAngle=f;
}}return this._rotationAngle;
},get_rotation:function(){return this._getRotationFromAngle(this.get_rotationAngle());
},get_url:function(){return this.getImage().src;
},get_serverUrl:function(){return this._serverUrl;
},set_serverUrl:function(d){this._serverUrl=d;
},get_viewMatrix:function(){return this._viewMatrix;
},set_viewMatrix:function(d){this._viewMatrix=d;
},get_imageKey:function(){return c(this.getImage()).data("key");
},set_imageKey:function(e){var d=c(this.getImage());
if(e===undefined){d.removeData("key");
}else{d.data("key",e);
}},add_imageReload:function(d){this._reloadEventCallbacks.push(d);
},remove_imageReload:function(d){Array.remove(this._reloadEventCallbacks,d);
},saveOnClient:function(f){var d=this.get_url();
if(d){var g=f?"&fileName="+f+"&path=":"&path=";
if(d.indexOf("Telerik.Web.UI.WebResource.axd?type=iec")!=-1){document.location=d+g+"1";
}else{var e=document.location+"";
e=e.substring(0,e.lastIndexOf("/")+1);
document.location=e+"Telerik.Web.UI.WebResource.axd?type=iec"+g+this.get_serverUrl();
}}},dispose:function(){this._attachToImageLoad(false);
delete this._image;
},_applyChangesOnServer:function(h,d,i,g){this._clientSave={c:i,n:d};
var e=h==true?{save:"1",overwrite:g==true?"1":"0",fName:typeof(d)=="string"?d:""}:{};
var f=new b.SwapImageOperation(this,"");
f._canUndo=false;
this._doServerOperation(c.extend({name:"Save",key:this.get_imageKey()},e),Function.createDelegate(this,this._finishSave),f);
if(h||i){this.getImage().src="";
this._resetCSS();
}},_finishSave:function(){},_setInternalSize:function(d,e){this._width=d;
this._height=e;
},_setSize:function(d,e){this._isResized=true;
if(this._getIsHorizontal()){this._setInternalSize(d,e);
}else{this._setInternalSize(e,d);
}this._applySize(d,e);
this._updateTransformOrigin(this.getImage(),this.get_rotationAngle(),parseInt(d),parseInt(e));
this.zoom(this.get_zoomLevel(),this._isResized);
},_applySize:function(d,e){this.getImage().style.width=d==""?"":d+"px";
this.getImage().style.height=e==""?"":e+"px";
},_setOpacity:function(d){this._opacity=d;
this._changeOpacity();
},_changeOpacity:function(f,g){if(!f){f=this.getImage();
}if(typeof(g)=="undefined"||g==null){g=this._opacity;
}var d=($telerik.isIE9Mode)?null:f.filters;
if(d){var e=d.item("DXImageTransform.Microsoft.Alpha");
if(e){e.opacity=g;
}}else{var h=(g/100);
f.style.opacity=h;
f.style.MozOpacity=h;
}},_setFlipDirection:function(e,f){var d=this._getFlipDirections(e);
if(f||this._flipV==this._flipH){this._flipV=d.flipV;
this._flipH=d.flipH;
}else{if(d.flipH==d.flipV){this._flipH=this._flipV=d.flipH;
}else{this._flipV=(this._flipV||d.flipV);
this._flipH=(this._flipH||d.flipH);
}}this._flip(null,this._flipH,this._flipV);
},_flip:function(g,f,h){if(!g){g=this.getImage();
}var d=($telerik.isIE9Mode)?null:g.filters;
var e=this.get_rotationAngle();
if(f==null||typeof(f)=="undefined"){f=this._flipH;
h=this._flipV;
}if(d){d.item("flipH").enabled=f?1:0;
d.item("flipV").enabled=h?1:0;
}else{this._updateCssTransform(f,h,e,g,true);
}},_updateCssTransform:function(f,l,i,h,d){if(!h){h=this.getImage();
}var g=h.width;
var e=h.height;
var k=h.style.OTransform;
if($telerik.isOpera&&(k.indexOf("90deg")!=-1||k.indexOf("270deg")!=-1)){if(h.style.width){g=parseInt(h.style.width);
e=parseInt(h.style.height);
}else{var m=g;
g=e;
e=m;
}}this._updateTransformOrigin(h,i,g,e);
var j=i!=0?"rotate("+i+"deg)":"";
j+=f?" scaleX(-1)":"";
j+=l?" scaleY(-1)":"";
if(j=="rotate(90deg) scaleX(-1)"||j=="rotate(90deg) scaleX(-1) scaleY(-1)"){j+=" translateX("+(((e/g)-1)*100)+"%)";
}if(j=="rotate(270deg) scaleY(-1)"||j=="rotate(270deg) scaleX(-1) scaleY(-1)"){j+=" translateY("+(((g/e)-1)*100)+"%)";
}h.style.MozTransform=j;
h.style.OTransform=j;
h.style.WebkitTransform=j;
h.style.transform=j;
if($telerik.isIE9Mode){h.style["-ms-transform"]=j;
}this._updateViewMatrix(f,l,i);
},_updateTransformOrigin:function(g,f,h,e){if(g){var d=this._getTransformOrigin(f,h,e);
g.style.MozTransformOrigin=d;
g.style.OTransformOrigin=d;
g.style.WebkitTransformOrigin=d;
g.style.transformOrigin=d;
if($telerik.isIE9Mode){g.style["-ms-transform-origin"]=d;
}}},_getTransformOrigin:function(e,f,d){var g="50% 50%";
if(e==90){g=(d/2)+"px 50%";
}else{if(e==270){g="50% "+(f/2)+"px";
}}return g;
},_getFlipDirections:function(e){var f=(e==b.FlipDirection.Vertical||e==b.FlipDirection.Both);
var d=(e==b.FlipDirection.Horizontal||e==b.FlipDirection.Both);
return(this._getIsHorizontal()?{flipV:f,flipH:d}:{flipV:d,flipH:f});
},_getFlipDirection:function(d,e){return(d&&e?b.FlipDirection.Both:(d?b.FlipDirection.Horizontal:(e?b.FlipDirection.Vertical:b.FlipDirection.None)));
},_getIsHorizontal:function(){var d=this.get_rotationAngle();
return(d==0||d==180);
},_setRotationAngle:function(d){this._rotationAngle=d;
this._rotate();
},_rotate:function(j,k){if(!j){j=this.getImage();
}if(k==null||typeof(k)=="undefined"){k=this.get_rotationAngle();
}var i=this._getFlipDirections(this.get_flipDirection());
var l=($telerik.isIE9Mode)?null:j.filters;
if(l){var h=l.item("DXImageTransform.Microsoft.Matrix");
if(h){var g=Math.PI*2/360;
var e=k*g;
var d=Math.cos(e);
var f=Math.sin(e);
h.M11=d;
h.M12=-f;
h.M21=f;
h.M22=d;
}}else{this._updateCssTransform(i.flipH,i.flipV,k,j);
}},_getRotationFromAngle:function(d){return d?(d==90?b.Rotation.Rotate90:(d==180?b.Rotation.Rotate180:(d==270?b.Rotation.Rotate270:b.Rotation.None))):b.Rotation.None;
},_transformBounds:function(d){var g=new Sys.UI.Bounds(d.x,d.y,d.width,d.height);
var h=this.get_viewMatrix();
var i=h.multiplyVector([g.x,g.y]);
var e=h.multiplyVector([g.x+g.width,g.y+g.height]);
var f=new Sys.UI.Bounds(Math.min(i[0],e[0]),Math.min(i[1],e[1]),Math.abs(e[0]-i[0]),Math.abs(e[1]-i[1]));
return f;
},_updateViewMatrix:function(h,f,d){h=h||this.flipH;
f=f||this.flipV;
d=d||this.get_rotationAngle();
var g=this.getImage();
var j=[g.width,g.height];
var i=[j[0]/2,j[1]/2];
var e=b.Matrix3x3.identityMatrix.clone();
this._addTranslation(e,d==90||d==270?[-i[1],-i[0]]:[-i[0],-i[1]]);
if(d){e=b.Matrix3x3["rotate"+d+"Matrix"].multiply(e);
}if(h){e=b.Matrix3x3.flipXMatrix.multiply(e);
}if(f){e=b.Matrix3x3.flipYMatrix.multiply(e);
}this._addTranslation(e,i);
this.set_viewMatrix(e);
},_applyViewTransformation:function(d){this.set_viewMatrix(d.multiply(this.get_viewMatrix()));
},_addTranslation:function(e,d){e.m13+=d[0];
e.m23+=d[1];
},_imageLoadedHandler:function(d){this._raiseImageReloadEvent();
if(this._clientSave&&this._clientSave.c){this.saveOnClient(this._clientSave.n);
this._clientSave={};
}},_raiseImageReloadEvent:function(){for(var d=0;
d<this._reloadEventCallbacks.length;
d++){this._reloadEventCallbacks[d]();
}},_attachToImageLoad:function(d){if(d){this._imageLoadedDelegate=Function.createDelegate(this,this._imageLoadedHandler);
$addHandler(this.getImage(),"load",this._imageLoadedDelegate);
}else{$removeHandler(this.getImage(),"load",this._imageLoadedDelegate);
delete this._imageLoadedDelegate;
}},_doServerOperation:function(d,g,h){d.clientOps=this._imageEditor._operationSerializer.serializeLastClientOperations(this._imageEditor._undoStack);
if(this._imageEditor){d.undoLimitKey=this._imageEditor._undoLimitKey;
this._imageEditor._undoLimitKey="";
this._imageEditor._lowerUndoBound=0;
}var e=this._serializeData(d);
var f=Function.createDelegate(this,Function.createCallback(this._finishOperation,g));
WebForm_DoCallback(this._xmlHttpPanel._uniqueId,e,f,{data:d,operation:h},function(){},false);
},_serializeData:function(d){var e={Value:typeof(d)=="string"?d:Sys.Serialization.JavaScriptSerializer.serialize(d)};
return Sys.Serialization.JavaScriptSerializer.serialize(e);
},_finishOperation:function(h,d,g){var e=this._readJson(h);
d.operation.set_key(e.key);
d.operation.set_src(e.url);
if(this._applyOperation(d.operation)){if(typeof(g)=="function"){g.call(this,d.data);
}}if(e.serverUrl){this.set_serverUrl(e.serverUrl);
}if(d.data.name=="Save"&&this._imageEditor){var f=e.alertMessage?e.alertMessage:this._imageEditor._getMessage("SaveServer");
this._imageEditor.raiseEvent("saved",new b.SavedEventArgs(e.fileName,true,f,e.args));
}this._alertMessage(e.alertMessage);
},_readJson:function(d){return Sys.Serialization.JavaScriptSerializer.deserialize(d);
},_getOriginalSwapImageOperation:function(){if(typeof(this._originalSwapImageOperation)==="undefined"){this._originalSwapImageOperation=new b.SwapImageOperation(this,this._getSrcAttr());
this._originalSwapImageOperation._canUndo=false;
}return this._originalSwapImageOperation;
},_setOriginalSwapImageOperation:function(){var d=this._getSrcAttr();
var e=Function.createDelegate(this,function(){this._originalSwapImageOperation=new b.SwapImageOperation(this,d);
this._originalSwapImageOperation._canUndo=false;
this.remove_imageReload(e);
});
this.add_imageReload(e);
this._useCacheBuster();
},_useCacheBuster:function(){var d=this._getSrcAttr();
if(!d){return;
}if(d.indexOf("Telerik.Web.UI.WebResource.axd?type=iec")!=-1){return;
}var e=(d.indexOf("?")==-1?"?c=":"&c=")+Math.random();
this.getImage().src=d+e;
},_getSrcAttr:function(){return this.getImage().getAttribute("src");
},_alertMessage:function(d){if(d){alert(d);
}}};
b.EditableImage.registerClass("Telerik.Web.UI.ImageEditor.EditableImage",null);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI");
(function(){Telerik.Web.UI.ImageEditorShortCutManager=function(a){this._shortcuts=[];
this.addShortCuts(a);
};
Telerik.Web.UI.ImageEditorShortCutManager.prototype={addShortCuts:function(a){if(typeof(a)=="string"){a=Sys.Serialization.JavaScriptSerializer.deserialize(a);
}for(var b=0;
b<a.length;
b++){this.addShortCut(a[b][0],a[b][1]);
}},addShortCut:function(b,c){var a=new Telerik.Web.UI.ImageEditorShortCut(b,c);
a.HashValue=this._getShortCutHashValue(a);
this._shortcuts[a.HashValue]=a;
},removeShortCut:function(b){var a=this.findShortCutByName(b);
if(a){this._shortcuts[a.HashValue]=null;
}},setShortCut:function(b,a){this.removeShortCut(b);
this.addShortCut(b,a);
},isShortCutHit:function(a){return this._hitTest(a.keyCode,a.ctrlKey,(null!=a.ctrlLeft?a.ctrlLeft:a.ctrlKey),a.shiftKey,(null!=a.shiftLeft?a.shiftLeft:a.shiftKey),a.altKey,(null!=a.altLeft?a.altLeft:a.altKey));
},_hitTest:function(e,h,g,b,a,f,c){var d=this._getHashValue(e,h,g,b,a,f,c);
return this._shortcuts[d];
},_getHashValue:function(f,i,h,c,b,g,e){var a=f&65535;
var d=0;
d|=(i?(1<<0):0);
d|=(c?(1<<2):0);
d|=(g?(1<<4):0);
a|=(d<<16);
return a;
},_getShortCutHashValue:function(a){return this._getHashValue(a.KeyCode,a.CtrlKey,a.LeftCtrlKey,a.ShiftKey,a.LeftShiftKey,a.AltKey,a.LeftAltKey);
},findShortCutByName:function(c){var b;
for(var a in this._shortcuts){b=this._shortcuts[a];
if(null!=b&&b._name==c){return b;
}}return null;
}};
Telerik.Web.UI.ImageEditorShortCutManager.registerClass("Telerik.Web.UI.ImageEditorShortCutManager",null);
Telerik.Web.UI.ImageEditorShortCut=function(b,a){this._name=b;
this._shortcutString="";
this.setShortCut(a);
};
Telerik.Web.UI.ImageEditorShortCut.prototype={CtrlKey:false,LeftCtrlKey:false,ShiftKey:false,LeftShiftKey:false,AltKey:false,LeftAltKey:false,KeyCode:0,get_name:function(){return this._name;
},set_name:function(a){this._name=a;
},get_shortCutString:function(){return this._shortcutString;
},setShortCut:function(a){this._parseShortcutString(a);
this._shortcutString=a;
},_parseShortcutString:function(c){if("string"==typeof(c)){this.CtrlKey=false;
this.LeftCtrlKey=false;
this.ShiftKey=false;
this.LeftShiftKey=false;
this.AltKey=false;
this.LeftAltKey=false;
this.KeyCode=0;
c=c.replace(/\s*/gi,"");
c=c.replace(/\+\+/gi,"+PLUS");
var d=c.split("+");
var b="";
for(var a=0;
a<d.length;
a++){b=d[a].toUpperCase();
switch(b){case"LCTRL":this.LeftCtrlKey=true;
case"CTRL":this.CtrlKey=true;
break;
case"LSHIFT":this.LeftShiftKey=true;
case"SHIFT":this.ShiftKey=true;
break;
case"LALT":this.LeftAltKey=true;
case"ALT":this.AltKey=true;
break;
case"F1":this.KeyCode=112;
break;
case"F2":this.KeyCode=113;
break;
case"F3":this.KeyCode=114;
break;
case"F4":this.KeyCode=115;
break;
case"F5":this.KeyCode=116;
break;
case"F6":this.KeyCode=117;
break;
case"F7":this.KeyCode=118;
break;
case"F8":this.KeyCode=119;
break;
case"F9":this.KeyCode=120;
break;
case"F10":this.KeyCode=121;
break;
case"F11":this.KeyCode=122;
break;
case"F12":this.KeyCode=123;
break;
case"ENTER":this.KeyCode=13;
break;
case"HOME":this.KeyCode=36;
break;
case"END":this.KeyCode=35;
break;
case"LEFT":this.KeyCode=37;
break;
case"RIGHT":this.KeyCode=39;
break;
case"UP":this.KeyCode=38;
break;
case"DOWN":this.KeyCode=40;
break;
case"PAGEUP":this.KeyCode=33;
break;
case"PAGEDOWN":this.KeyCode=34;
break;
case"SPACE":this.KeyCode=32;
break;
case"TAB":this.KeyCode=9;
break;
case"BACK":this.KeyCode=8;
break;
case"CONTEXT":this.KeyCode=93;
break;
case"ESCAPE":case"ESC":this.KeyCode=27;
break;
case"DELETE":case"DEL":this.KeyCode=46;
break;
case"INSERT":case"INS":this.KeyCode=45;
break;
case"PLUS":this.KeyCode="+".charCodeAt(0);
break;
default:this.KeyCode=b.charCodeAt(0);
break;
}}}else{throw {description:"Invalid shortcut string"};
}}};
Telerik.Web.UI.ImageEditorShortCut.registerClass("Telerik.Web.UI.ImageEditorShortCut",null);
})();
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.ImageOperationSerializer=function(d){this.imageEditor=d;
};
b.ImageOperationSerializer.prototype={serializeOperationStack:function(d){return"["+d.join(",")+"]";
},serializeUndoStack:function(m,d){if(!d){return"[]";
}var k={};
var l=m.length;
for(var e=0;
e<l;
e++){var f=m[e];
if(f.get_name()=="Rotate"){f.set_index(1);
}k[f.get_name()]=f;
}var g="";
for(var j in k){var h=k[j];
if(h.getIsClientOperation()){g+=h.toString(d)+",";
}}g=g?"["+g.slice(0,-1)+"]":"[]";
return g;
},serializeLastClientOperations:function(d){return this.serializeClientOperations(this.getLastClientOperations(d));
},getLastClientOperations:function(f){var d=[];
for(var e=f.length-1;
e>=0;
e--){var g=f[e];
if(g.getIsClientOperation()){d.unshift(g);
}else{break;
}}return d;
},serializeClientOperations:function(k){var h={};
for(var e=0;
e<k.length;
e++){var f=k[e];
if(f.get_name()=="Rotate"){f.set_index(1);
}h[f.get_name()]=f;
}var d=this.imageEditor.getEditableImage();
var g="";
for(var j in h){g+=h[j].toString(d)+",";
}return g?"["+g.slice(0,-1)+"]":"[]";
},deserializeOperationStack:function(d){var h=[];
var f=this.deserializeJson(d);
for(var e=0,g=f.length;
e<g;
e++){h.push(this.deserializeOperation(f[e]));
}return h;
},deserializeOperation:function(e){var d=this.deserializeJson(e);
return this._initializeOperation(d);
},_initializeOperation:function(d){var e=this.createOperationByName(d.name);
e.fromData(d);
return e;
},createOperationByName:function(d){var e=this.getOperationClassByName(d);
if(e){return new e(this.imageEditor.getEditableImage());
}else{return null;
}},getOperationClassByName:function(d){return a.ImageEditor[d+"Operation"]||null;
},deserializeJson:function(d){return typeof(d)=="string"?Sys.Serialization.JavaScriptSerializer.deserialize(d):d;
}};
b.ImageOperationSerializer.registerClass("Telerik.Web.UI.ImageEditor.ImageOperationSerializer");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI");
(function(b,a){$telerik.toImageEditor=function(c){return c;
};
$telerik.findImageEditor=$find;
Telerik.Web.UI.RadImageEditor=function(c){Telerik.Web.UI.RadImageEditor.initializeBase(this,[c]);
this._postbackButtonElement=null;
this._toolsPanel=null;
this._toolBarPanel=null;
this._toolGroups=[];
this._tools=null;
this._xmlHttpPanel=null;
this._currentCommand=null;
this._location=null;
this._height="500px";
this._width="585px";
this._enableResize=true;
this._isOurRequest=false;
this._shortCutManager=null;
this._originalDockToolbarWidth="600px";
this._tabIndex=0;
this._accessKey="";
this._undoLimitKey="";
this._lowerUndoBound=0;
this._image=null;
this._editableImage=null;
this._undoStack=[];
this._redoStack=[];
this._operationSerializer=new a.ImageEditor.ImageOperationSerializer(this);
};
Telerik.Web.UI.RadImageEditor.prototype={initialize:function(){Telerik.Web.UI.RadImageEditor.callBaseMethod(this,"initialize");
this._attachToolbarHandlers(true);
this._attachToolbarPanelHandlers(true);
this._attachToolsPanelHandlers(true);
this._attachXmlHttpPanelHandlers(true);
this._attachPageRequestManagerHandlers();
var c=this.get_toolsPanel();
c._form.appendChild(c.get_element());
this._editableImage=new Telerik.Web.UI.ImageEditor.EditableImage(this.getImage(),$find(this.get_id()+"_eiXHPanel"),this);
this._editableImage.set_serverUrl(this.get_serverImageUrl());
this._statusBar=new a.ImageEditor.StatusBar(this._getChildElement("SB"),this);
this._attachToImageLoad(true);
this._createUndoRedoStacks();
this._setRightToLeft();
this._configureToolbar();
this.set_height(this._getMaxHeight());
this.set_width(this.get_width());
this._makeResizable();
this._createDraggableImage();
this._createScrollToZoom();
this._registerShortcuts();
this.raiseEvent("load",Sys.EventArgs.Empty);
},dispose:function(){if(this._currentToolWidget){this._currentToolWidget.dispose();
this._currentToolWidget=null;
}if(this._statusBar){this._statusBar.dispose();
}this._attachShortcutHandlers(false);
this._shortCutManager=null;
Telerik.Web.UI.RadImageEditor.callBaseMethod(this,"dispose");
var c=this.getEditableImage();
if(c){c.dispose();
}this._attachToImageLoad(false);
},repaint:function(){this.set_height(this._getMaxHeight());
this._configureToolbar();
},saveClientState:function(){var g=["currentCommand","imageKey","serverImageUrl","height","width","enableResize","toolBarPosition","isf"];
var e={};
var h=g.length;
for(var d=0;
d<h;
d++){var f=g[d];
e[f]=this["get_"+f]();
}this._saveUndoRedoClientState(e);
var c=this.getEditableImage();
var j=c.get_imageKey();
if(j){e.imageKey=j;
}if(this.get_serverImageUrl()!=c.get_serverUrl()){e.imageUrl=c.get_serverUrl();
}return Sys.Serialization.JavaScriptSerializer.serialize(e);
},_saveUndoRedoClientState:function(c){c.clientOps=this._operationSerializer.serializeLastClientOperations(this._undoStack);
},_configureToolbar:function(){var m=this._statusBar._element;
if(m&&Sys.UI.DomElement.containsCssClass(m.parentNode,"RadImageEditor")){b("div.rieZoneLeft").css("top","20px");
b("div.rieZoneRight").css("top","20px");
}var o=this.get_toolBarPanel();
if(o){if(!o.get_dockZoneID()){o._form.appendChild(o.get_element());
}o.get_contentContainer().parentNode.setAttribute("colSpan","3");
var c=0;
var l=this.get_toolGroupsLength();
var n=this.get_toolGroups();
for(var d=0;
d<l;
d++){c+=n[d].get_element().offsetWidth;
}if(c>0){if(l>1){var j=parseInt(this.get_width());
o._width=(c>j?j:c)+"px";
o._setWidthHtmlEl(o._width);
}else{o._width=c+"px";
n[0].get_element().style.width="100%";
}this._originalDockToolbarWidth=o._width;
}}var h;
var g=null;
if(this.get_toolBarMode()==a.ImageEditor.ToolBarMode.Default){h="";
g=this.get_toolBarContainer();
}else{h="auto 5px";
}var p=this.get_viewport();
p.style.margin=h;
var e=this.get_toolBarPosition();
if(e==a.ImageEditor.ToolBarPosition.Top||e==a.ImageEditor.ToolBarPosition.Bottom){this._setToolbarOrientation(a.Orientation.Horizontal);
}else{this._setToolbarOrientation(a.Orientation.Vertical);
if(o){o._width=this._getVerticalDockWidth()+"px";
o._setWidthHtmlEl(o._width);
}if(g){this._setViewPortMargin(g,(this._getVerticalDockWidth()+4)+"px");
}else{var k=this.get_leftZone();
var f=this.get_rightZone();
if(k&&k.get_element().children.length>2){p.style.marginLeft=(this._getVerticalDockWidth()+4)+"px";
}else{if(f&&f.get_element().children.length>2){p.style.marginRight=(this._getVerticalDockWidth()+4)+"px";
}}}}},_getVerticalDockWidth:function(){var c=this.get_rightZone();
if(c){return c.get_element().offsetWidth;
}return 32;
},_setRightToLeft:function(){var d=null;
var c=this.get_element();
if(c){d=$telerik.isRightToLeft(c);
}this._isRightToLeft=d;
if(d){Sys.UI.DomElement.addCssClass(c,"rieRtl");
}},requestToolWidget:function(c){var d=this.get_toolsLoadPanelType();
if(d=="AjaxPanel"){this.initAjaxRequest(c);
}else{this.initCallback(c);
}},initAjaxRequest:function(d,c){if(!this._isOurRequest||c){this._isOurRequest=true;
this._ajaxRequestInited=true;
this._showAjaxLoadingPanel();
__doPostBack(this.get_postbackButtonElement().getAttribute("name"),d);
}},initCallback:function(d,c){if(!this._isOurRequest||c){this._isOurRequest=true;
this._showAjaxLoadingPanel();
this.get_xmlHttpPanel().set_value(d);
}},_showAjaxLoadingPanel:function(){var c=this.get_ajaxLoadingPanel();
if(c){c.get_element().style.paddingBottom="7px";
var d=this.get_toolsPanel();
d.get_contentContainer().style.minHeight="52px";
$telerik.getElementByClassName(d.get_element(),"rdMiddle","tr").id=this.get_id()+"_rdMiddle";
c.show(this.get_id()+"_rdMiddle");
}},openToolsPanel:function(){var d=this.get_toolsPanel();
if(d.get_top()==0&&d.get_left()==0){var c=this.get_location();
d.set_top(c.y+70);
if(this._isRightToLeft){d.set_left(c.x-280);
}else{d.set_left(c.x+470);
}}d.set_closed(false);
},closeToolsPanel:function(){this.get_toolsPanel().set_closed(true);
},setToggleState:function(e,c){if(!e){return;
}if(e.get_checked){e.set_checked(c);
}else{var d=this.get_tools()[e];
if(d&&d.get_checked){d.set_checked(c);
}}},getImage:function(){if(!this._image){this._image=this._getChildElement("EditableImage");
}return this._image;
},getEditableImage:function(){return this._editableImage;
},fire:function(g,e){var d=e&&e.get_domEvent?e.get_domEvent():null;
var f=new a.ImageEditor.CancelEventArgs(d,g);
this.raiseEvent("commandExecuting",f);
if(f.get_cancel()){return;
}var c=a.ImageEditor.CommandList[g];
if(c){c(this,g,e);
}else{alert("Could not find the command "+g+". Please update your command list.");
}this.raiseEvent("commandExecuted",new a.ImageEditor.EventArgs(d,g));
},executeCommand:function(c){if(this._isOurRequest){return;
}if(this._currentToolWidget&&this._currentToolWidget.get_name()!=c){this._currentToolWidget.dispose();
this._currentToolWidget=null;
}this.openToolsPanel();
this.setToggleState(c,true);
if(!this._currentToolWidget){this.requestToolWidget(c);
}this.set_currentCommand(c);
},undo:function(c){this._undo(c||1);
},redo:function(c){this._redo(c||1);
},resetChanges:function(){var d=this._preExecuteOperation("Reset",true,false);
if(d.cancel){return;
}var e=this.getEditableImage();
this.set_imageKey("");
e.set_serverUrl(this.get_serverImageUrl());
this._clearCommandsToRedo();
this._clearCommandsToUndo();
this._enableDisableUndoRedoTools();
e.reset(this.get_clientImageUrl());
this.updateClientState();
this._statusBar.setValue("None","lastAction");
this._statusBar.setValue("100","zoom");
var c=this;
window.setTimeout(function(){c._statusBar._updateSizeInternal();
if(c._currentToolWidget){c._currentToolWidget.updateUI();
}},0);
this._executeOperation(null,false,false,{CommandName:"Reset"});
},changeImageOpacity:function(d,c){this._changeImageOpacity(d,true,c);
},flipImage:function(d,e,c){this._flipImage(d,true,e,c);
},flipHorizontal:function(){var c=this.getEditableImage().get_flipDirection();
switch(c){case a.ImageEditor.FlipDirection.None:c=a.ImageEditor.FlipDirection.Horizontal;
break;
case a.ImageEditor.FlipDirection.Horizontal:c=a.ImageEditor.FlipDirection.None;
break;
case a.ImageEditor.FlipDirection.Vertical:c=a.ImageEditor.FlipDirection.Both;
break;
default:c=a.ImageEditor.FlipDirection.Vertical;
break;
}this.flipImage(c,true);
},flipVertical:function(){var c=this.getEditableImage().get_flipDirection();
switch(c){case a.ImageEditor.FlipDirection.None:c=a.ImageEditor.FlipDirection.Vertical;
break;
case a.ImageEditor.FlipDirection.Horizontal:c=a.ImageEditor.FlipDirection.Both;
break;
case a.ImageEditor.FlipDirection.Vertical:c=a.ImageEditor.FlipDirection.None;
break;
default:c=a.ImageEditor.FlipDirection.Horizontal;
break;
}this.flipImage(c,true);
},rotateImage:function(d,c){this._rotateImage(d,true,c);
},rotateLeft90:function(){var c=this.getEditableImage().get_rotationAngle()-90;
if(c<0){c=c+360;
}this._rotateImage(null,true,true,c);
},rotateRight90:function(){var c=this.getEditableImage().get_rotationAngle()+90;
if(c==360){c=0;
}this._rotateImage(null,true,true,c);
},resizeImage:function(d,c,e){this._resizeImage(d,c,true,e);
},zoomImage:function(c,d){this._zoomImage(c,d);
},zoomIn:function(){var c=parseInt(this.getEditableImage().get_zoomLevel()/50)*50+50;
if(c>this.get_upperZoomBound()){c=this.get_upperZoomBound();
}this.zoomImage(c,true);
},zoomOut:function(){var c=parseInt(this.getEditableImage().get_zoomLevel()/50)*50-50;
if(c<this.get_lowerZoomBound()){c=this.get_lowerZoomBound();
}this.zoomImage(c,true);
},zoomBestFit:function(){var d=this.getEditableImage();
if(d){var c=this.get_viewport();
d.zoomBestFit(c.offsetWidth,c.offsetHeight);
this._statusBar.setValue(d.get_zoomLevel(),"zoom");
this._executeOperation(null,false,true,{CommandName:"Zoom"});
}},insertImage:function(e,f,c,d){this._insertImage(e,f,c,d);
},saveImageOnClient:function(d){var c=this.get_allowedSavingLocation();
if(c==a.ImageEditor.AllowedSavingLocation.ClientAndServer||c==a.ImageEditor.AllowedSavingLocation.Client){this._applyChangesOnServer(true,false,d);
}},saveImageOnServer:function(c,e){var d=this.get_allowedSavingLocation();
if(d==a.ImageEditor.AllowedSavingLocation.ClientAndServer||d==a.ImageEditor.AllowedSavingLocation.Server){this._applyChangesOnServer(false,true,c,e);
}},applyChangesOnServer:function(){this._applyChangesOnServer();
},get_toolsPanel:function(){if(this._toolsPanel){return this._toolsPanel;
}else{this._toolsPanel=this._findChildControl("ToolsPanel");
return this._toolsPanel;
}},get_toolBarPanel:function(){if(this._toolBarPanel){return this._toolBarPanel;
}else{this._toolBarPanel=this._findChildControl("ToolbarPanel");
return this._toolBarPanel;
}},get_topZone:function(){if(this._topZone){return this._topZone;
}else{this._topZone=this._findChildControl("ZoneTop");
return this._topZone;
}},get_rightZone:function(){if(this._rightZone){return this._rightZone;
}else{this._rightZone=this._findChildControl("ZoneRight");
return this._rightZone;
}},get_bottomZone:function(){if(this._bottomZone){return this._bottomZone;
}else{this._bottomZone=this._findChildControl("ZoneBottom");
return this._bottomZone;
}},get_leftZone:function(){if(this._leftZone){return this._leftZone;
}else{this._leftZone=this._findChildControl("ZoneLeft");
return this._leftZone;
}},get_toolGroups:function(){var c=this.get_toolGroupsLength();
if(this._toolGroups.length!=c){for(var d=0;
d<c;
d++){Array.add(this._toolGroups,this._getToolbarControl(d));
}}return this._toolGroups;
},_getToolbarControl:function(c){if(this.get_toolBarMode()==a.ImageEditor.ToolBarMode.Default){return this._findChildControl("ToolGroup"+c);
}else{return this._findChildControl("ToolbarPanel_C_ToolGroup"+c);
}},get_tools:function(){if(!this._tools){this._tools={};
var h=this.get_toolGroups();
var f=h.length;
for(var c=0;
c<f;
c++){var e=h[c].get_allItems();
var g=e.length;
for(var d=0;
d<g;
d++){if(!e[d].get_isSeparator||!e[d].get_isSeparator()){this._tools[e[d].get_commandName()]=e[d];
}}}}return this._tools;
},get_currentCommand:function(){return this._currentCommand;
},set_currentCommand:function(d){var c=this._currentCommand!=d;
this._currentCommand=d;
if(this.get_isInitialized()&&c){this._currentCommand=d;
}},get_currentToolWidget:function(){return this._currentToolWidget;
},set_currentToolWidget:function(c){this._currentToolWidget=c;
},get_xmlHttpPanel:function(){if(!this._xmlHttpPanel){this._xmlHttpPanel=$find(this.get_id()+"_ToolsPanel_C_XHPanel");
}return this._xmlHttpPanel;
},get_ajaxLoadingPanel:function(){if(!this._ajaxLoadingPanel){this._ajaxLoadingPanel=this._findChildControl("RALP");
}return this._ajaxLoadingPanel;
},get_formDecorator:function(){if(!this._formDecorator){this._formDecorator=$find(this.get_id()+"_FormDecorator");
}return this._formDecorator;
},get_resizeHandle:function(){if(!this._resizeHandle){this._resizeHandle=this._getChildElement("ResizeHandle");
}return this._resizeHandle;
},get_toolBarContainer:function(){if(!this._toolBarContainer){this._toolBarContainer=$telerik.getElementByClassName(this.get_element(),"rieToolBar","div");
}return this._toolBarContainer;
},get_viewport:function(){if(!this._viewport){this._viewport=this._getChildElement("Viewport");
}return this._viewport;
},get_postbackButtonElement:function(){if(!this._postbackButtonElement){this._postbackButtonElement=$get(this.get_postbackButton());
}return this._postbackButtonElement;
},get_operationsToUndo:function(){return this._undoStack;
},get_operationsToRedo:function(){return this._redoStack;
},get_isUndoAvailable:function(){return(this._undoStack.length>this._lowerUndoBound);
},get_isRedoAvailable:function(){return(this._redoStack.length>0);
},get_enableResize:function(){return this._enableResize;
},set_enableResize:function(d){this._enableResize=d;
this._makeResizable();
var c=this.get_resizeHandle();
if(d){c.style.cursor="";
Sys.UI.DomElement.addCssClass(c,"rieResizeHandle");
}else{c.style.cursor="default";
Sys.UI.DomElement.removeCssClass(c,"rieResizeHandle");
}if(this.get_isInitialized()){this.updateClientState();
}},get_upperZoomBound:function(){return 400;
},get_lowerZoomBound:function(){return 25;
},get_minHeight:function(){return 300;
},get_minWidth:function(){return 585;
},get_top:function(){return this.get_location().y;
},get_left:function(){return this.get_location().x;
},get_location:function(c){if(c||!this._location){this._location=!$telerik.isOpera?$telerik.getLocation(this.getImage()):$telerik.originalGetLocation(this.getImage());
}return this._location;
},get_height:function(){return this._height;
},set_height:function(d){if(d==""){return;
}var c=this.get_isInitialized();
if(d.toString().indexOf("%")>-1){this._height=parseInt(d)+"%";
if(c){this.get_viewport().style.height=this._height;
}}else{d=parseInt(d);
this._height=parseInt(d)+"px";
if(c){this.get_viewport().style.height=(d-this._getDeltaHeight())+"px";
}}this._setDockZonesMinHeight();
if(c){this.get_element().style.height="";
this.updateClientState();
}},get_width:function(){return this._width;
},set_width:function(c){if(c==""){return;
}if(c.toString().indexOf("%")>-1){this._width=parseInt(c)+"%";
}else{this._width=parseInt(c)+"px";
}if(this.get_isInitialized()){this.get_element().style.width=this._width;
this.updateClientState();
}},_createScrollToZoom:function(){var c=this.getEditableImage();
this._scrollToZoom=new a.ImageEditor.ScrollToZoom(this.get_viewport(),{maxZoomLevel:this.get_upperZoomBound(),minZoomLevel:this.get_lowerZoomBound(),getZoomLevel:b.proxy(c.get_zoomLevel,c),onZoom:b.proxy(this._scrollToZoomHandler,this)});
},_scrollToZoomHandler:function(c){this.zoomImage(c,true);
},_createDraggableImage:function(){var d=this.get_viewport();
var c=this;
this._scrollExtender=new a.TouchScrollExtender(d);
a.ImageEditor.extendMethod(this._scrollExtender,"_startDrag",function(){d.style.cursor="move";
});
a.ImageEditor.extendMethod(this._scrollExtender,"_endDrag",function(){d.style.cursor="default";
c._focus(c.get_element());
});
this._scrollExtender.initialize();
},_undo:function(d){if(d>this._undoStack.length-this._lowerUndoBound){d=this._undoStack.length-this._lowerUndoBound;
}if(d>this._undoStack.length){d=this._undoStack.length;
}var e=this._undoStack.splice(this._undoStack.length-d,d);
if(this._getLastServerOperation(e)){this._undoFromServerOperation(e);
}else{this._simpleUndo(e);
}var c=this._undoStack[this._undoStack.length-1];
this._statusBar.setValue((c?c.get_text():"None"),"lastAction");
this._statusBar._updateSizeInternal();
this.updateClientState();
if(this._currentToolWidget){this._currentToolWidget.updateUI();
}this._enableDisableUndoRedoTools();
},_simpleUndo:function(d){while(d.length){var c=d.pop();
c.undo();
this._redoStack.push(c);
this._updateUndoRedoDropDowns("Redo",c);
}},_undoFromServerOperation:function(f){for(var c=f.length-1;
c>=0;
c--){var d=f[c];
this._redoStack.push(d);
this._updateUndoRedoDropDowns("Redo",d);
}var g=this._operationSerializer.getLastClientOperations(this._undoStack);
var h=this._undoStack.length-g.length-1;
var e=h>-1?this._undoStack[h]:this.getEditableImage()._getOriginalSwapImageOperation();
g.unshift(e);
while(g.length){g.shift().execute();
}},_getLastServerOperation:function(e){for(var c=e.length-1;
c>=0;
c--){var d=e[c];
if(!d.getIsClientOperation()){return d;
}}return null;
},_redo:function(d){if(d>this._redoStack.length){d=this._redoStack.length;
}var c;
while(0<d--){c=this._redoStack.pop();
c.execute();
this._undoStack.push(c);
this._updateUndoRedoDropDowns("Undo",c);
}if(c){this._statusBar.setValue(c.get_text(),"lastAction");
}this.updateClientState();
if(this._currentToolWidget){this._currentToolWidget.updateUI();
}this._enableDisableUndoRedoTools();
},_updateUndoRedoDropDowns:function(k,e){var f=this.get_tools();
var i=f.Undo;
var d=f.Redo;
if(this._shouldModifyUndoRedoDropDowns&&i&&d){var c=i.get_buttons?i.get_buttons():null;
var j=d.get_buttons?d.get_buttons():null;
var h=(k=="Undo"||k==null)?c:j;
var g=k=="Redo"?c:j;
if(k!=null){window.setTimeout(function(){if(g){g.removeAt(0);
}},0);
}else{k="Undo";
}if(h){h.insert(0,this._createToolBarButton(e.get_text(),k));
}}},_createUndoRedoStacks:function(){this._enableDisableUndoRedoTools();
},_enableDisableUndoRedoTools:function(){var c=this.get_tools();
var d=c.Undo;
if(d){d.set_enabled(this.get_isUndoAvailable());
}var e=c.Redo;
if(e){e.set_enabled(this.get_isRedoAvailable());
}},_clearCommandsToRedo:function(){if(this.get_isRedoAvailable()){var c=this.get_tools();
var d=c?c.Redo:null;
if(d&&d.get_buttons){d.hideDropDown();
d.get_buttons().clear();
}this._redoStack.splice(0,this._redoStack.length);
}},_clearCommandsToUndo:function(){if(this.get_isUndoAvailable()){var c=this.get_tools();
var d=c?c.Undo:null;
if(d&&d.get_buttons){d.hideDropDown();
d.get_buttons().clear();
}this._undoStack.splice(0,this._undoStack.length);
}},_createUndoRedoDropDown:function(d,f,c){var g=d.get_buttons();
g.clear();
var e=f.length;
if(typeof(c)==="undefined"){c=0;
}while(c<e--){g.add(this._createToolBarButton(f[e].get_text(),d.get_commandName()));
}},_createToolBarButton:function(c,e){var d=new Telerik.Web.UI.RadToolBarButton();
d.set_text(c);
d.set_commandName(e);
return d;
},_changeImageOpacity:function(e,f,c){var d=this._preExecuteOperation("Opacity",e,c);
if(d.cancel){return;
}e=d.args.get_argument();
c=d.args.get_updateUI();
if(this._operation){this._operation.set_currentOpacity(e);
}this._operation=this.getEditableImage().changeOpacity(e,this._operation);
this._executeOperation(this._operation,f,c);
},_flipImage:function(d,g,e,c){var f=this._preExecuteOperation("Flip",d,e);
if(f.cancel){return;
}d=f.args.get_argument();
e=f.args.get_updateUI();
if(this._operation){this._operation.set_flipDirection(d);
}this._operation=this.getEditableImage().flip(d,c,this._operation);
this._executeOperation(this._operation,g,e);
},_rotateImage:function(c,g,f,d){var e=this._preExecuteOperation("Rotate",c,f);
if(e.cancel){return;
}c=e.args.get_argument();
f=e.args.get_updateUI();
if(this._operation){this._operation.set_rotation(c,d);
}this._operation=this.getEditableImage().rotate(c,d,this._operation);
this._statusBar.updateSize();
this._executeOperation(this._operation,g,f);
},_resizeImage:function(e,d,f,h){var g=this._preExecuteOperation("Resize",{width:e,height:d},h);
if(g.cancel){return;
}e=g.args.get_argument().width;
d=g.args.get_argument().height;
h=g.args.get_updateUI();
if(this._operation){this._operation.set_size(e,d);
}var c=this.getEditableImage();
this._operation=c.resize(e,d,this._operation);
this._statusBar.updateSize(c.get_width(),c.get_height());
this._executeOperation(this._operation,f,h);
},_zoomImage:function(d,e){var f=this._preExecuteOperation("Zoom",d,e);
if(f.cancel){return;
}d=f.args.get_argument();
e=f.args.get_updateUI();
var c=this.getEditableImage();
c.zoom(d);
this._statusBar.setValue(c.get_zoomLevel(),"zoom");
this._executeOperation(null,false,e,{CommandName:"Zoom"});
},_cropImage:function(e){var c=this._preExecuteOperation("Crop",e,false);
if(c.cancel){return;
}e=c.args.get_argument();
var d=this.getEditableImage();
this._executeOperation(d.crop(e),true,true);
},addTextToImage:function(f,g,c){var d=this._preExecuteOperation("AddText",{x:f,y:g,text:c},false);
if(d.cancel){return;
}f=d.args.get_argument().x;
g=d.args.get_argument().y;
c=d.args.get_argument().text;
var e=this.getEditableImage();
this._executeOperation(e.addText(f,g,c),true,true);
},_insertImage:function(d,e,c,g){var h=this._preExecuteOperation("InsertImage",{x:d,y:e,value:c,operations:g},false);
if(h.cancel){return;
}d=h.args.get_argument().x;
e=h.args.get_argument().y;
c=h.args.get_argument().value;
g=h.args.get_argument().operations;
var f=this.getEditableImage();
this._executeOperation(f.insertImage(d,e,c,g),true,true);
},_applyChangesOnServer:function(f,i,c,e){var d=f||i;
var j=new a.ImageEditor.SavingEventArgs(d?(f?"SaveClient":"SaveServer"):"ApplyChanges",c,e);
this.raiseEvent("saving",j);
if(j.get_cancel()){return false;
}c=j.get_fileName();
var g=this.getEditableImage();
var h=this._undoStack.length!=0&&this._undoStack[this._undoStack.length-1].getIsClientOperation();
if(h||i){g._applyChangesOnServer(i,c,f,e);
this._clearCommandsToRedo();
this._clearCommandsToUndo();
this._enableDisableUndoRedoTools();
}else{if(f){g.saveOnClient(c);
this.raiseEvent("saved",new a.ImageEditor.SavedEventArgs(c,true,this._getMessage(j.get_saveAction())));
}}},_getMessage:function(c){switch(c){case"SaveClient":return"The image was saved successfully on the client";
case"SaveServer":return"The image was saved successfully on the server";
default:return"Changes applied successfully";
}},_preExecuteOperation:function(i,e,h){var f=new a.ImageEditor.ImageChangeCancelEventArgs(null,i,e,h);
this.raiseEvent("imageChanging",f);
if(f.get_cancel()){if(this._currentToolWidget){this._currentToolWidget.updateUI();
}return{cancel:true,args:f};
}var d=this._undoStack.length;
var c=this.get_undoLimit();
var g=d>=c?this._undoStack[d-c]:null;
if(g&&!g.getIsClientOperation()){this._undoLimitKey=g.get_key();
}return{cancel:false,args:f};
},_executeOperation:function(d,e,g,h){if(e){this._updateUndoRedoDropDowns(null,d);
var c=this.get_undoLimit();
if(c!=0&&this._undoStack.length>=c+this._lowerUndoBound){this._lowerUndoBound++;
var f=this.get_tools()["Undo"];
if(f&&f.get_buttons){f.get_buttons().removeAt(c);
}}this._undoStack.push(d);
this._statusBar.setValue(d.get_text(),"lastAction");
this._clearCommandsToRedo();
this._enableDisableUndoRedoTools();
this._operation=null;
this.updateClientState();
}if(g&&this._currentToolWidget){this._currentToolWidget.updateUI();
}var h=new a.ImageEditor.ImageChangeEventArgs(null,h?h.CommandName:d.get_name(),d);
this.raiseEvent("imageChanged",h);
},_closeToolsPanelAndSaveCommand:function(c){this.closeToolsPanel();
this.set_currentCommand(c);
},_getMaxHeight:function(){var f=this.get_toolBarPanel();
if(f&&f.get_dockZoneID()==""){return this._height;
}var e=this._getDeltaHeight();
var g=parseInt(this.get_height())-e;
var c=this._getToolbarControl(0);
var d=c?c.get_element().parentNode.offsetHeight:null;
if(d&&d>g){g=d+e+(f?10:0);
}return g>parseInt(this._height)?g:this._height;
},_attachToolbarHandlers:function(c){var f=this.get_toolGroups();
if(c){var d=f.length;
for(var e=0;
e<d;
e++){f[e].add_buttonClicking(Function.createDelegate(this,this._preventToolbarButtonClick));
f[e].add_buttonClicked(Function.createDelegate(this,this._toolBarButtonClicked));
f[e].add_dropDownOpening(Function.createDelegate(this,this._undoRedoToolOpening));
}}},_preventToolbarButtonClick:function(c,d){d.set_cancel(this._isOurRequest);
},_toolBarButtonClicked:function(e,d){var c=d.get_item();
this.fire(c.get_commandName(),d);
},_undoRedoToolOpening:function(e,d){var c=d.get_item();
var f=c.get_commandName();
if(!this._shouldModifyUndoRedoDropDowns){if(f=="Undo"){this._createUndoRedoDropDown(c,this.get_operationsToUndo(),this._lowerUndoBound);
this._shouldModifyUndoRedoDropDowns=true;
}else{if(f=="Redo"){this._createUndoRedoDropDown(c,this.get_operationsToRedo());
this._shouldModifyUndoRedoDropDowns=true;
}}this._setDropDownCssClass();
}},_setDropDownCssClass:function(){var c=this.get_tools();
var d=c.Undo;
var e=c.Redo;
if(d){if(d.get_buttons){Sys.UI.DomElement.addCssClass(d.get_dropDownElement(),"rieDropDown");
}}if(e){if(e.get_buttons){Sys.UI.DomElement.addCssClass(e.get_dropDownElement(),"rieDropDown");
}}},_attachToolbarPanelHandlers:function(c){var d=this.get_toolBarPanel();
if(c&&d){d.add_dragEnd(Function.createDelegate(this,this._onToolbarDragEnd));
d.add_enterZone(Function.createDelegate(this,this._onEnterZone));
d.add_leaveZone(Function.createDelegate(this,this._onLeaveZone));
}},_onEnterZone:function(c,d){this._setViewPortMargin(d.dockZone.get_element(),(this._getVerticalDockWidth()+4)+"px");
},_onLeaveZone:function(c,d){this._setViewPortMargin(d.dockZone.get_element(),"5px");
},_setViewPortMargin:function(c,d){if(Sys.UI.DomElement.containsCssClass(c,"rieZoneLeft")){this.get_viewport().style.marginLeft=d;
}else{if(Sys.UI.DomElement.containsCssClass(c,"rieZoneRight")){this.get_viewport().style.marginRight=d;
}}},_onToolbarDragEnd:function(f,i){var h=f.get_dockZoneID();
if(h){var c=this.get_viewport();
var g=h.indexOf("ZoneRight")!=-1;
var d=this.get_toolBarPosition();
if(g||h.indexOf("ZoneLeft")!=-1){if(d==a.ImageEditor.ToolBarPosition.Top||d==a.ImageEditor.ToolBarPosition.Bottom){this._originalDockToolbarWidth=f._width;
}f._width=this._getVerticalDockWidth()+"px";
this._setToolbarOrientation(a.Orientation.Vertical);
var e=f.get_element().offsetHeight;
if(e>parseInt(c.style.height)){this.set_height(e+this._getDeltaHeight());
}d=g?a.ImageEditor.ToolBarPosition.Right:a.ImageEditor.ToolBarPosition.Left;
}else{if(f.get_dockZone().get_fitDocks()){f._width=this._originalDockToolbarWidth;
}else{f.set_width(this._originalDockToolbarWidth);
}this._setToolbarOrientation(a.Orientation.Horizontal);
d=h.indexOf("ZoneTop")!=-1?a.ImageEditor.ToolBarPosition.Top:a.ImageEditor.ToolBarPosition.Bottom;
}this.set_toolBarPosition(d);
}this.updateClientState();
this._focus(this.get_element());
},get_isf:function(){var c=this.get_toolBarPanel();
if(c){return(c.get_dockZoneID()==""?"1":"0");
}return"0";
},_setToolbarOrientation:function(e){var c=this.get_toolGroups();
if(c){var f=c.length;
for(var g=0;
g<f;
g++){var d=c[g];
d.set_orientation(e);
}}},_attachToolsPanelHandlers:function(d){var c=this.get_toolsPanel();
if(d&&c){c.add_command(Function.createDelegate(this,this._toolsPanelEventHandler));
c.add_dragEnd(Function.createDelegate(this,this._onDockDragEnd));
}},_onDockDragEnd:function(c,d){this._focus(this.get_element());
},_toolsPanelEventHandler:function(c,d){if(d.command.get_name()=="Close"){if(c.get_closed()){this._toolsPanelClosed(c,d);
}else{this._toolsPanelOpen(c,d);
}}},_toolsPanelClosed:function(f,e){var g=this.get_currentCommand();
this.setToggleState(g,false);
this.set_currentCommand(null);
var d=this.get_currentToolWidget();
if(d){d.onClose();
}var c=new a.ImageEditor.EventArgs(null,g);
this.raiseEvent("toolsDialogClosed",c);
},_toolsPanelOpen:function(e,d){var c=this.get_currentToolWidget();
if(c){c.onOpen();
}},_attachXmlHttpPanelHandlers:function(d){this._ToolsPanelResponseEndedDelegate=Function.createDelegate(this,this._xmlPanelResponseEnded);
var c=this.get_xmlHttpPanel();
if(d&&c){c.add_responseEnded(this._ToolsPanelResponseEndedDelegate);
}},_xmlPanelResponseEnded:function(e,d){if(this._isOurRequest){this._hideAjaxLoadingPanel();
this._currentToolWidget=new Telerik.Web.UI.ImageEditor[this.get_currentCommand()](this);
var c=this.get_toolsPanel();
c.set_title(this._currentToolWidget.get_text()||"Tool Dialog");
if(c.get_width()!=270){c.set_width(270);
}this._currentToolWidget.updateUI();
}this._isOurRequest=false;
},_hideAjaxLoadingPanel:function(){var c=this.get_ajaxLoadingPanel();
if(c){var d=this.get_toolsPanel();
d.get_contentContainer().style.minHeight="";
this.get_ajaxLoadingPanel().hide(this.get_id()+"_rdMiddle");
}},_attachPageRequestManagerHandlers:function(){var c=Sys.WebForms.PageRequestManager.getInstance();
if(c){this._beginRequestDelegate=Function.createDelegate(this,this._beginRequest);
c.add_beginRequest(this._beginRequestDelegate);
if(this.get_toolsLoadPanelType()=="AjaxPanel"){this._handleToolAjaxLoadDelegate=Function.createDelegate(this,this._handleToolAjaxLoad);
c.add_endRequest(this._handleToolAjaxLoadDelegate);
}}},_attachToImageLoad:function(c){if(c){this._imageLoadedDelegate=Function.createDelegate(this,this._imageLoadedHandler);
$addHandler(this.getImage(),"load",this._imageLoadedDelegate);
}else{$removeHandler(this.getImage(),"load",this._imageLoadedDelegate);
delete this._imageLoadedDelegate;
}},_imageLoadedHandler:function(c){if(this._statusBar){var d=this.getEditableImage();
if(d){this._statusBar.updateSize(d.get_width(),d.get_height());
}if(this._currentToolWidget&&this._currentToolWidget.get_name()=="Resize"){this._currentToolWidget.updateUI();
}}this.updateClientState();
},_beginRequest:function(f,d){if(!this._ajaxRequestInited){var e=this.get_element();
e.appendChild(this.get_toolsPanel().get_element());
var c=this.get_toolBarPanel();
if(c&&!c.get_dockZoneID()){e.appendChild(c.get_element());
}f.remove_beginRequest(this._beginRequestDelegate);
this._beginRequestDelegate=null;
}this._ajaxRequestInited=false;
},_handleToolAjaxLoad:function(d,c){try{$telerik.evalScripts(this.get_toolsPanel().get_element(),this._ToolsPanelResponseEndedDelegate);
}catch(f){}},_getDeltaHeight:function(){var i=this.get_resizeHandle().parentNode;
var e=this.get_toolBarContainer();
var c=this._getChildElement("SB");
var f=0;
var g=this._getToolbarControl(0);
var d=g?g.get_element():null;
var h;
if(d!=null){h=d.style.cssFloat;
d.style.cssFloat="none";
}f=(this.get_toolBarPosition()==a.ImageEditor.ToolBarPosition.Top||this.get_toolBarPosition()==a.ImageEditor.ToolBarPosition.Bottom?e.offsetHeight:0)+(this.get_toolBarMode()==a.ImageEditor.ToolBarMode.Docked?this.get_bottomZone().get_element().offsetHeight:0)+i.offsetHeight+(c&&c.parentNode.className!=i.className?c.offsetHeight:0);
if(h){d.style.cssFloat=h;
}return f;
},_setDockZonesMinHeight:function(){var d=this._findChildControl("ZoneRight");
var c=this._findChildControl("ZoneLeft");
if(c){d.get_element().style.minHeight=this.get_viewport().style.height;
c.get_element().style.minHeight=this.get_viewport().style.height;
}},_makeResizable:function(){if(this._resizeExtender){this._resizeExtender.dispose();
this._resizeExtender=null;
}if(this.get_enableResize()){var c={};
if(this._isRightToLeft){c={sw:this.get_resizeHandle()};
}else{c={se:this.get_resizeHandle()};
}this._resizeExtender=new Telerik.Web.UI.ResizeExtender(this,this.get_element(),c);
this._resizeExtender._autoScrollEnabled=false;
}},onResizeStart:function(){Sys.UI.DomElement.addCssClass(this.get_element(),"rieTopLeftZero");
this._deltaHeight=this._getDeltaHeight()+2;
this.raiseEvent("resizeStart",Sys.EventArgs.Empty);
},onResizeEnd:function(){var c=this.get_element();
Sys.UI.DomElement.removeCssClass(c,"rieTopLeftZero");
c.style.top="";
c.style.left="";
this._height=c.style.height;
this._width=c.style.width;
this.updateClientState();
c.style.height="";
this._setDockZonesMinHeight();
if(this._isRightToLeft){this.get_location(true);
}this.raiseEvent("resizeEnd",new Sys.EventArgs());
},onResizing:function(c){var d=this.get_viewport();
if(c.width<this.get_minWidth()){return false;
}if(c.height<this.get_minHeight()){return false;
}d.style.height=(c.height-this._deltaHeight)+"px";
},addShortCut:function(d,c){if(this._shortCutManager){this._shortCutManager.addShortCut(d,c);
}},removeShortCut:function(c){if(this._shortCutManager){this._shortCutManager.removeShortCut(c);
}},setShortCut:function(d,c){if(this._shortCutManager){this._shortCutManager.setShortCut(d,c);
}},_getDefaultShortCuts:function(){var c=[["Undo","CTRL+Z"],["Redo","CTRL+Y"],["CloseToolsPanel","ESC"],["SetToolFocus","F10"]];
return c;
},_registerShortcuts:function(d){this._attachShortcutHandlers(d!==false);
if(!this._shortCutManager){this._shortCutManager=new a.ImageEditorShortCutManager(this._getDefaultShortCuts());
this._shortCutManager.addShortCuts(this.get_shortcuts());
}var c=this.get_element();
c.setAttribute("tabIndex",this._tabIndex.toString());
if(this._accessKey){c.setAttribute("accessKey",this._accessKey);
}},_attachShortcutHandlers:function(c){if(c){this._keyDownDelegate=Function.createDelegate(this,this._keyDown);
$addHandler(this.get_element(),"keydown",this._keyDownDelegate);
}else{$removeHandler(this.get_element(),"keydown",this._keyDownDelegate);
this._keyDownDelegate=null;
}},_keyDown:function(g){var f=this._shortCutManager.isShortCutHit(g.rawEvent);
if(!f){return;
}var d=new a.ImageEditor.ShortCutCancelEventArgs(g.rawEvent,f);
this.raiseEvent("shortCutHit",d);
if(!d.get_cancel()){var c=f.get_name();
switch(c){case"CloseToolsPanel":this.closeToolsPanel();
break;
case"SetToolFocus":this._focusToolbar();
break;
default:this.fire(c);
break;
}}$telerik.cancelRawEvent(g.rawEvent);
return false;
},_focusToolbar:function(){var c=this.get_toolBarContainer();
c.setAttribute("tabIndex","0");
this._focus(c);
},_focus:function(c){try{if(c.setActive){c.setActive();
}else{if(c.focus){c.focus();
}}return true;
}catch(d){return false;
}}};
b.registerControlProperties(a.RadImageEditor,{postbackButton:null,toolGroupsLength:0,imageKey:"",serverImageUrl:"",clientImageUrl:"",allowedSavingLocation:a.ImageEditor.AllowedSavingLocation.ClientAndServer,toolsLoadPanelType:"",shortcuts:[],toolBarMode:a.ImageEditor.ToolBarMode.Default,toolBarPosition:a.ImageEditor.ToolBarPosition.Top,defaultInsertedImageUrl:"",undoLimit:0});
b.registerControlEvents(a.RadImageEditor,["load","resizeStart","resizeEnd","commandExecuting","commandExecuted","imageChanging","imageChanged","saving","saved","toolsDialogClosed","shortCutHit"]);
Telerik.Web.UI.RadImageEditor.registerClass("Telerik.Web.UI.RadImageEditor",Telerik.Web.UI.RadWebControl);
})($telerik.$,Telerik.Web.UI);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.SwapImageOperation=function(g,e,f){b.SwapImageOperation.initializeBase(this);
this._editableImage=g;
this._image=g?g.getImage():null;
this.set_src(e);
this._canUndo=false;
this._originalSrc=this._image.src;
this._editableImageSize={width:g.get_width(),height:g.get_height()};
var d=g.get_zoomLevel()/100;
this._imageSize=f||{width:g.get_width()*d,height:g.get_height()*d};
this._originalWidth=g.get_width();
this._originalImageWidth=this._image.width;
this._originalHeight=g.get_height();
this._originalImageHeight=this._image.height;
};
b.SwapImageOperation.prototype={execute:function(){this._apply(this.get_src());
this._canUndo=true;
},_apply:function(d){this._editableImage.set_imageKey(this.getKeyFromSrc(d));
this._image.src=d;
this._resetCSSPersistZoom();
if(this._imageSize){var e=this._editableImage.get_zoomLevel()/100;
this._editableImage._applySize(this._editableImageSize.width*e,this._editableImageSize.height*e);
this._editableImage._setInternalSize(this._editableImageSize.width,this._editableImageSize.height);
}},undo:function(){if(this.canUndo()){this._apply(this._originalSrc);
this._editableImage._setInternalSize(this._originalWidth,this._originalHeight);
this._editableImage._applySize(this._originalImageWidth,this._originalImageHeight);
this._editableImage._updateCssTransform(this._editableImage._flipH,this._editableImage._flipV,this._editableImage.get_rotationAngle());
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),src:this.get_src(),key:this.getKeyFromSrc(this.get_src())});
},fromString:function(e){var d=Sys.Serialization.JavaScriptSerializer.deserialize(e);
this.fromData(d);
},fromData:function(d){if(d.name==this.get_name()){this.set_src(d.src);
}},canUndo:function(){return this._canUndo;
},get_name:function(){return"SwapImage";
},get_text:function(){return this.get_name();
},getIsClientOperation:function(){return false;
},get_image:function(){return this._image[0];
},getKeyFromSrc:function(d){var e=d.match(/&key=([^&]+)&?/i);
if(e){return e[1];
}},dispose:function(){delete this._canUndo;
delete this._image;
},_resetCSSPersistZoom:function(){var d=this._editableImage.get_zoomLevel();
this._editableImage._resetCSS();
this._editableImage._zoomLevel=d;
}};
c.registerControlProperties(b.SwapImageOperation,{src:null,key:null});
b.SwapImageOperation.registerClass("Telerik.Web.UI.ImageEditor.SwapImageOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.AddTextOperation=function(f,e,d){b.AddTextOperation.initializeBase(this,[f,e,d]);
};
b.AddTextOperation.prototype={get_name:function(){return"AddText";
},get_text:function(){return"AddText";
},toString:function(){return b.CropOperation.callBaseMethod(this,"toString");
}};
b.AddTextOperation.registerClass("Telerik.Web.UI.ImageEditor.AddTextOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.CropOperation=function(e,d,f){b.CropOperation.initializeBase(this,[e,d]);
this._bounds=f;
};
b.CropOperation.prototype={execute:function(){b.CropOperation.callBaseMethod(this,"execute");
this._finishRedo();
},_finishRedo:function(){var e=this._bounds;
this._editableImage._setInternalSize(e.width,e.height);
var d=this._editableImage.get_zoomLevel()/100;
this._editableImage._applySize(e.width*d,e.height*d);
},undo:function(){if(this.canUndo()){b.CropOperation.callBaseMethod(this,"undo");
this._isRedo=true;
}},get_name:function(){return"Crop";
},get_text:function(){return"Crop";
},toString:function(){return b.CropOperation.callBaseMethod(this,"toString");
}};
b.CropOperation.registerClass("Telerik.Web.UI.ImageEditor.CropOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.DraggableResizeBox=function(d){this.set_element(d);
this._cropBounds=null;
this._boxElement=null;
this._createUI();
this.scrollSettings={scrollEdgeConstSmall:20,scrollEdgeConst:30,scrollSpeed:2};
};
b.DraggableResizeBox.prototype={_createUI:function(){var d=c("<div class='rieDraggableResizeBox'>");
this._appendHandle(d);
d.append(c("<div class='rieDraggableResizeHandle rieTop rieLeft'>"));
d.append(c("<div class='rieDraggableResizeHandle rieTop rieMiddleH'>"));
d.append(c("<div class='rieDraggableResizeHandle rieTop rieRight'>"));
d.append(c("<div class='rieDraggableResizeHandle rieLeft rieMiddleV'>"));
d.append(c("<div class='rieDraggableResizeHandle rieRight rieMiddleV'>"));
d.append(c("<div class='rieDraggableResizeHandle rieBottom rieLeft'>"));
d.append(c("<div class='rieDraggableResizeHandle rieBottom rieMiddleH'>"));
d.append(c("<div class='rieDraggableResizeHandle rieBottom rieRight'>"));
this._jBoxElement=d;
this._boxElement=d[0];
this.get_element().appendChild(this._boxElement);
this._storeParentOffset();
this._setInitialPosition();
this._makeResizeable();
},_appendHandle:function(d){d.append(c("<div class='rieDraggableBoxMove'>"));
},_makeResizeable:function(){this.disposeResizeExtender();
if(this._boxElement){this._createResizeExtender();
}},_createResizeExtender:function(){var e=c(this._boxElement);
var d={nw:e.find(".rieTop.rieLeft",this)[0],n:e.find(".rieTop.rieMiddleH",this)[0],ne:e.find(".rieTop.rieRight",this)[0],w:e.find(".rieLeft.rieMiddleV",this)[0],e:e.find(".rieRight.rieMiddleV",this)[0],sw:e.find(".rieBottom.rieLeft",this)[0],s:e.find(".rieBottom.rieMiddleH",this)[0],se:e.find(".rieBottom.rieRight",this)[0],move:e.find(".rieDraggableBoxMove")[0]};
this._resizeExtender=new a.ResizeExtender(this,this._boxElement,d);
this._overrideResizeExtenderMethods();
this._resizeExtenderScroller=new b.ResizeExtenderScroller(this._resizeExtender);
this._resizeExtenderScroller.add_scrolling(c.proxy(this._onScrolling,this));
},_setInitialPosition:function(){var d=c(this.get_element());
this.setBounds({x:d.scrollLeft(),y:d.scrollTop(),width:50,height:50});
},_storeParentOffset:function(){var d=("relative"==$telerik.getCurrentStyle(this.get_element(),"position"));
this._offsetLocation=(d?$telerik.getLocation(this.get_element()):null);
},_raiseResizeEvent:function(d){var e=new Sys.EventArgs();
var f=this.getBounds();
e.getBounds=function(){return f;
};
e.get_value=function(){return d;
};
this.raiseEvent("boundsChanged",e);
},onResizing:function(d){return this._raiseResizeEvent(d);
},onResizeEnd:function(){this._resizeExtenderScroller.stopScrolling();
return this._raiseResizeEvent();
},onDragEnd:function(){this._resizeExtenderScroller.stopScrolling();
return this._raiseResizeEvent();
},onDrag:function(){this._manageScroller();
return this._raiseResizeEvent();
},onDragStart:function(){return this._resizeExtenderScroller.startScrolling();
},onResizeStart:function(){return this._resizeExtenderScroller.startScrolling();
},show:function(){this.setVisible(true);
},hide:function(){this.setVisible(false);
},dispose:function(){this.disposeResizeExtender();
if(this._boxElement.parentNode){this._boxElement.parentNode.removeChild(this._boxElement);
}this._boxElement=this._jBoxElement=null;
},disposeResizeExtender:function(){if(this._resizeExtender){this._resizeExtender.dispose();
this._resizeExtender=null;
}},setVisible:function(e){var f=this._boxElement;
f.style.visibility=e?"visible":"hidden";
var d=$telerik.getScrollOffset(f.parentNode);
$telerik.setLocation(f,d);
},getBounds:function(){var d=this.getPosition();
var e=this.getSize();
return new Sys.UI.Bounds(d.left,d.top,e.width,e.height);
},getPosition:function(){var d=this._jBoxElement.position();
var e=this._jBoxElement.parent();
var f={left:e.scrollLeft(),top:e.scrollTop()};
return{left:d.left+f.left,top:d.top+f.top};
},getSize:function(){return{width:this._jBoxElement.outerWidth(),height:this._jBoxElement.outerHeight()};
},setBounds:function(d){if(d.width<2){d.width=2;
}if(d.height<2){d.height=2;
}$telerik.setBounds(this._boxElement,d);
},get_constraints:function(){return this._resizeExtender.get_constraints();
},set_constraints:function(d){this._resizeExtender.set_constraints(d);
d.horizontal=d.x+d.width;
d.vertical=d.y+d.height;
},get_maxWidth:function(){var e=this.getBounds();
var d=this.get_constraints();
return d.width-e.x;
},get_maxHeight:function(){var e=this.getBounds();
var d=this.get_constraints();
return d.height-e.y;
},add_boundsChanged:function(d){c(this).bind("boundsChanged",d);
},remove_boundsChanged:function(d){c(this).unbind("boundsChanged",d);
},raiseEvent:function(d,e){c(this).trigger(d,[e]);
},get_sizeRatio:function(){return this._ratio;
},set_sizeRatio:function(d){this._ratio=d;
this._resizeExtender._ratio=d;
},_fixOriginalBoundsIssue:function(){this._jsOwner._resizeExtender_storeStartCoords.apply(this,arguments);
this._borderDims=this._jsOwner._getBorderDims();
this._originalBounds=this._jsOwner.getBounds();
this._offsetLocation={x:0,y:0};
},_overrideResizeExtenderMethods:function(){this._resizeExtender._resize=Function.createDelegate(this._resizeExtender,this._resizeExtenderResizeMethod);
this._resizeExtender_storeStartCoords=this._resizeExtender._storeStartCoords;
this._resizeExtender._storeStartCoords=Function.createDelegate(this._resizeExtender,this._fixOriginalBoundsIssue);
},_resizeExtenderResizeMethod:function(q){if(!this._enabled||this._cancelResize){return false;
}var n=this._originalBounds;
var f=new Sys.UI.Bounds(0,0,0,0);
var p=($telerik.isMobileSafari||$telerik.isAndroid)?$telerik.getTouchEventLocation(q):{x:q.clientX,y:q.clientY};
var i=p.x-this._startX;
var j=p.y-this._startY;
var h=this._resizeDir;
var m=h.move;
if(m){var r=this._startCursorLocation;
if(r){n.x=r.x;
n.y=r.y;
this._originalBounds=n;
this._startCursorLocation=null;
}f.x=n.x+i;
f.y=n.y+j;
var d=this._getMoveConstraints(n);
if(d){f.x=this._constrainPosition(f.x,d.x,d.width);
f.y=this._constrainPosition(f.y,d.y,d.height);
}}else{if(h.east){f.x=n.x;
f.width=n.width+i;
}else{if(h.west){f.x=p.x-this._leftHandleMouseDelta;
f.width=n.width-i;
}}if(h.south){f.y=n.y;
f.height=n.height+j;
}else{if(h.north){f.y=n.y+j;
f.height=n.height-j;
}}var s=this._getSizeConstraints(n);
if(s){f.x=f.x||n.x;
f.y=f.y||n.y;
if(h.west){f.x=this._constrainPosition(f.x,s.x,Math.min(f.x+f.width,s.width-f.width));
}if(h.north){f.y=this._constrainPosition(f.y,s.y,Math.min(f.y+f.height,s.height-f.height));
}s.width-=f.x+this._borderDims.horizontal;
s.height-=f.y+this._borderDims.vertical;
f.width=this._constrainDimension(f.width,s.width);
f.height=this._constrainDimension(f.height,s.height);
}if(this._ratio){var l=f.width/this._ratio;
var k=f.height*this._ratio;
if(h.east||h.west){f.height=s?this._constrainDimension(l,s.height):l;
f.width=f.height*this._ratio;
}else{f.width=s?this._constrainDimension(k,s.width):k;
f.height=f.width/this._ratio;
}}}var o=m?this._raiseDragEvent("Drag",f,q):this._raiseEvent("Resizing",f);
if(false==o){return true;
}var g=this._element;
if(m||f.x>0){g.style.left=f.x+"px";
}if(m||f.y>0){g.style.top=f.y+"px";
}if(f.width>0){g.style.width=f.width+"px";
}if(f.height>0){g.style.height=f.height+"px";
}return true;
},_manageScroller:function(){this._resizeExtenderScroller.manageScrolling();
if(this._resizeExtenderScroller._scrollerX||this._resizeExtenderScroller._scrollerY){this._resizeExtender.__startX=this._resizeExtender._startX;
this._resizeExtender.__startY=this._resizeExtender._startY;
}else{if(this._resizeExtenderScroller._scrollTimer.get_enabled()){this._resizeExtender._startX=this._resizeExtender.__startX;
this._resizeExtender._startY=this._resizeExtender.__startY;
}}},_onScrolling:function(d,e){this._resizeExtender._startX-=e.newScroll.left-e.oldScroll.left;
this._resizeExtender._startY-=e.newScroll.top-e.oldScroll.top;
this._raiseResizeEvent();
},_getBorderDims:function(){return $telerik.getBorderBox(this._resizeExtender._element);
}};
c.registerControlProperties(b.DraggableResizeBox,{element:null});
b.DraggableResizeBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableResizeBox");
b.DraggableImageResizeBox=function(d){this._imageElement=null;
this._jImageElement=null;
b.DraggableImageResizeBox.initializeBase(this,[d]);
};
b.DraggableImageResizeBox.prototype={dispose:function(){this.attachHandlers(false);
this._imageElement=this._jImageElement=null;
b.DraggableImageResizeBox.callBaseMethod(this,"dispose");
},_appendHandle:function(d){var e=c("<div class='rieDraggableBoxMove rieDraggableBoxImage'>");
this._jImageElement=c("<img alt='Insert clip art' style='width:100%; height:100%;'>");
e.append(this._jImageElement);
d.append(e);
this._imageElement=this._jImageElement[0];
this.attachHandlers(true);
},_imageLoadHandler:function(d){this._setInitialSize();
},_setInitialSize:function(){this._jImageElement.css("width","");
this._jImageElement.css("height","");
this.setSize({width:this._imageElement.width,height:this._imageElement.height});
this._jImageElement.css("width","100%");
this._jImageElement.css("height","100%");
this._raiseResizeEvent(true);
},attachHandlers:function(d){if(d){this._imageLoadDelegate=Function.createDelegate(this,this._imageLoadHandler);
$telerik.addHandler(this._imageElement,"load",this._imageLoadDelegate);
}else{$telerik.removeHandler(this._imageElement,"load",this._imageLoadDelegate);
delete this._imageLoadDelegate;
}},set_src:function(d){this._jImageElement.attr("src",d);
this._setInitialSize();
},get_src:function(){if(this._jImageElement){return this._jImageElement.attr("src");
}},setSize:function(d){if(d.width<2){d.width=2;
}if(d.height<2){d.height=2;
}$telerik.setSize(this._boxElement,d);
},get_imageElement:function(){return this._imageElement;
},get_jImageElement:function(){return this._jImageElement;
}};
b.DraggableImageResizeBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableImageResizeBox",b.DraggableResizeBox);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.DraggableTextBox=function(d){this.set_container(d);
this._textSettings=new b.ImageText();
this._createUI();
};
b.DraggableTextBox.prototype={dispose:function(){this._disposeResizeExtender();
this._boxContent.remove();
this._boxElement.remove();
this._boxElement=this._boxContent=null;
},_disposeResizeExtender:function(){if(this._resizeExtender){this._resizeExtender.dispose();
}this._resizeExtender=null;
},get_text:function(){return this._textSettings.get_text();
},set_text:function(d){this._textSettings.set_text(d);
try{var f=this._formatTextToHtml();
this._boxContent.html(f);
this._updateTextSize();
}catch(g){}},get_textSettings:function(){return this._textSettings;
},set_textSettings:function(d){this._textSettings=d;
this.set_text(d.get_text());
this._updateTextAppearance();
},get_fontFamily:function(){return this._textSettings.get_fontFamily();
},set_fontFamily:function(d){this._textSettings.set_fontFamily(d);
this._updateTextAppearance();
},get_fontSize:function(){return this._textSettings.get_fontSize();
},set_fontSize:function(d){this._textSettings.set_fontSize(d);
this._updateTextAppearance();
},get_color:function(){return this._textSettings.get_color();
},set_color:function(d){this._textSettings.set_color(d);
this._updateTextCss();
},get_bounds:function(){var d=this._boxElement;
return new Sys.UI.Bounds(parseInt(d.css("left")),parseInt(d.css("top")),parseInt(d.css("width")),parseInt(d.css("height")));
},set_bounds:function(d){this.set_position(d);
this.set_size(d);
},get_size:function(){var d=this._boxElement;
return{width:parseInt(d.css("width")),height:parseInt(d.css("height"))};
},set_size:function(d){this._boxElement.css({width:d.width,height:d.height});
},get_position:function(){var d=this._boxElement;
return{x:parseInt(d.css("left")),y:parseInt(d.css("top"))};
},set_position:function(d){this._boxElement.css({top:d.y,left:d.x});
},show:function(){this._setVisible("visible");
},hide:function(){this._setVisible("hidden");
},add_boundsChanged:function(d){c(this).bind("boundsChanged",d);
},remove_boundsChanged:function(d){c(this).unbind("boundsChanged",d);
},onDrag:function(e){var d=this.get_container();
e.x+=d.scrollLeft;
e.y+=d.scrollTop;
c(this).trigger("boundsChanged");
this._resizeExtenderScroller.manageScrolling();
},onDragEnd:function(){this._resizeExtenderScroller.stopScrolling();
c(this).trigger("boundsChanged");
},_createUI:function(){this._createBox();
this.set_text(this.get_text());
this._createResizeExtender();
},_createBox:function(){this._boxElement=c('<div class="rieDraggableTextBox"/>');
this._boxContent=c('<span class="rieDraggableTextBoxContent"/>');
this._boxElement.append(this._boxContent);
c(this.get_container()).append(this._boxElement);
},_createResizeExtender:function(){this._resizeExtender=new a.ResizeExtender(this,this._boxElement[0],{move:this._boxContent[0]});
this._resizeExtenderScroller=new b.ResizeExtenderScroller(this._resizeExtender);
},_updateTextAppearance:function(){this._updateTextCss();
this._updateTextSize();
},_updateTextCss:function(){this._boxContent.css({fontFamily:this._textSettings.get_fontFamily(),fontSize:this._textSettings.get_fontSize(),color:this._textSettings.get_color()});
},_updateTextBounds:function(){this.set_bounds(this._getUpdatedTextBounds());
},_updateTextSize:function(){this.set_size(this._getUpdatedTextBounds());
},_getUpdatedTextBounds:function(){this._boxElement.css({width:65536});
var d=$telerik.getBounds(this._boxContent[0]);
d.width+=parseInt(this._boxElement.css("padding-left"))+parseInt(this._boxElement.css("padding-right"))+1;
d.height+=parseInt(this._boxElement.css("padding-top"))+parseInt(this._boxElement.css("padding-bottom"))+1;
return d;
},_setVisible:function(d){this._boxElement.css({visibility:d});
},_formatTextToHtml:function(){return this.get_text().replace(/\n/g,"<br/>");
},onDragStart:function(){return this._resizeExtenderScroller.startScrolling();
}};
c.registerControlProperties(b.DraggableTextBox,{container:c("body")[0]});
b.DraggableTextBox.registerClass("Telerik.Web.UI.ImageEditor.DraggableTextBox");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.FlipOperation=function(e,d,f){b.FlipOperation.initializeBase(this);
this._editableImage=e;
this._image=e?e.getImage():null;
this.set_flipDirection(d);
this._canUndo=false;
this._prevFlipDirection=b.FlipDirection.None;
this._clearPrevFlipDirection=f;
};
b.FlipOperation.prototype={execute:function(){this.flip(this.get_flipDirection());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this._flipV=false;
this._flipH=false;
this.flip(this.get_originalFlipDirection());
this._canUndo=false;
}},toString:function(e){var d=e?e._getAbsFlipDirection():this.get_flipDirection();
return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),direction:d,index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Flip";
},get_text:function(){return this.get_name()+" "+this.get_flipDirectionText();
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_flipDirectionText:function(){var d="";
switch(this.get_flipDirection()){case b.FlipDirection.None:d="None";
break;
case b.FlipDirection.Horizontal:d="Horizontal";
break;
case b.FlipDirection.Vertical:d="Vertical";
break;
default:d="Both";
break;
}return d;
},get_flipDirection:function(){return this._flipDirection;
},set_flipDirection:function(d){this._flipDirection=typeof(d)=="undefined"||d==null?b.FlipDirection.None:d;
},get_originalFlipDirection:function(){return this._prevFlipDirection;
},flip:function(d){this._prevFlipDirection=this.get_editableImage().get_flipDirection();
this._updateImage(d);
},_updateImage:function(d){this.get_editableImage()._setFlipDirection(d,this._clearPrevFlipDirection);
},_getFlipDirection:function(d,e){return(d&&e?b.FlipDirection.Both:(d?b.FlipDirection.Horizontal:(e?b.FlipDirection.Vertical:b.FlipDirection.None)));
}};
b.FlipOperation.registerClass("Telerik.Web.UI.ImageEditor.FlipOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.InsertImageOperation=function(e,d,f){b.InsertImageOperation.initializeBase(this,[e,d]);
};
b.InsertImageOperation.prototype={get_name:function(){return"InsertImage";
},get_text:function(){return"Image Inserted";
},toString:function(){return b.InsertImageOperation.callBaseMethod(this,"toString");
}};
b.InsertImageOperation.registerClass("Telerik.Web.UI.ImageEditor.InsertImageOperation",b.SwapImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.ScrollToZoom=function(d,e){this.element=d;
this.setOptions(e);
this.currentZoomLevel=100;
this._scroller=new b.MouseScroll(d,Function.createDelegate(this,this.mouseScrollHandler),{timeToAccumulate:50,throttleTime:10,specialKey:this.options.specialKey});
};
b.ScrollToZoom.prototype={mouseScrollHandler:function(f,e){if(this.options.specialKey&&!f[this.options.specialKey]){return false;
}var g=this.getDocPos(f);
var d=this.documentToElementPos(g,this.element);
this.handleZoomScroll(d,e);
},handleZoomScroll:function(h,j){j=this.calculateSpeed(j);
this.currentZoomLevel=this.options.getZoomLevel();
var f=this.calculateNewZoomLevel(j);
this.options.onZoom(f);
var e=this.elementToContentPos(h);
var d=f/this.currentZoomLevel;
var i={x:e.x*d-h.x,y:e.y*d-h.y};
var g=c(this.element);
g.scrollLeft(i.x);
g.scrollTop(i.y);
},documentToElementPos:function(e,d){var f=c(d).offset();
return{x:e.x-f.left,y:e.y-f.top};
},elementToContentPos:function(d){var e=this.getElementScroll(this.element);
return{x:(d.x+e.x),y:(d.y+e.y)};
},setOptions:function(d){this.options=c.extend({getZoomLevel:Function.emptyFunction,maxZoomLevel:400,minZoomLevel:25,onZoom:Function.emptyFunction,speed:10,specialKey:"altKey"},d||{});
},calculateNewZoomLevel:function(d){var e=this.options.getZoomLevel();
return Math.min(Math.max(e+d,this.options.minZoomLevel),this.options.maxZoomLevel);
},calculateSpeed:function(d){return this.getDirection(d)*this.options.speed;
},getDirection:function(d){return this._scroller._normalizeDelta(d);
},getDocPos:function(d){return{x:d.clientX,y:d.clientY};
},getElementScroll:function(d){var e=c(d);
return{x:e.scrollLeft(),y:e.scrollTop()};
},dispose:function(){delete this.element;
}};
b.MouseScroll=function(d,e,f){this.element=d;
this._accumulatedScroll=0;
this.setOptions(f);
this.set_externalHandler(e);
this.attachMouseWheel();
};
b.MouseScroll.prototype={handleMouseScroll:function(d){this._checkSpecialKey(d);
this.callExternalMethod(d,this.wheel(d.rawEvent));
},callExternalMethod:function(e,d){this.externalHandler(e,d);
},handleMouseScrollWithAccumulation:function(e){this._checkSpecialKey(e);
var d=this.wheel(e.rawEvent);
this._accumulateScroll(d);
this._currentEvent=e;
this.startAccumulateTimer();
},startAccumulateTimer:function(){if(!this.accumulateTimer){this.accumulateTimer=setTimeout(Function.createDelegate(this,this.finishAccumulating),this.options.timeToAccumulate);
}},finishAccumulating:function(d){this.callExternalMethod(this._currentEvent,this._accumulatedScroll);
this.clearAccumulating();
},wheel:function(d){var e=0;
if(d.wheelDelta){e=d.wheelDelta/40;
}else{if(d.detail){e=-d.detail;
}}return e>0?Math.ceil(e):Math.floor(e);
},setOptions:function(d){this.options=c.extend({timeToAccumulate:200,throttleTime:null,specialKey:""},d||{});
},attachMouseWheel:function(){this.internalHandler=this.options.timeToAccumulate?Function.createDelegate(this,this.handleMouseScrollWithAccumulation):Function.createDelegate(this,this.handleMouseScroll);
$telerik.addHandler(this.element,"mousewheel",this.internalHandler);
$telerik.addHandler(this.element,"DOMMouseScroll",this.internalHandler);
},detachMouseWheel:function(){$telerik.removeHandler(this.element,"mousewheel",this.internalHandler);
$telerik.removeHandler(this.element,"DOMMouseScroll",this.internalHandler);
delete this.internalHandler;
},clearAccumulating:function(){clearTimeout(this.accumulateTimer);
delete this._currentEvent;
delete this.accumulateTimer;
this._accumulatedScroll=0;
},set_externalHandler:function(d){this.externalHandler=d||Function.emptyFunction;
if(this.options.throttleTime){this.externalHandler=c.throttle(this.options.throttleTime,this.externalHandler);
}},dispose:function(){this.detachMouseWheel();
delete this.element;
},_checkSpecialKey:function(e){var d=this.options.specialKey&&e[this.options.specialKey];
if(d){$telerik.cancelRawEvent(e.rawEvent);
}return !d;
},_accumulateScroll:function(d){this._accumulatedScroll+=this._normalizeDelta(d);
},_normalizeDelta:function(d){return d==0?0:(d<0?-1:1);
}};
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.OpacityOperation=function(e,f,d){b.OpacityOperation.initializeBase(this);
this._editableImage=e;
this._image=e?e.getImage():null;
this._canUndo=false;
this.set_currentOpacity(f);
this._prevOpacity=d;
};
b.OpacityOperation.prototype={execute:function(){this._updateImage(this.get_currentOpacity(),true);
this._canUndo=true;
},undo:function(){if(this.canUndo()){this._updateImage(this.get_originalOpacity(),false);
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),value:this.get_currentOpacity(),index:this.get_index()});
},fromString:function(e){var d=Sys.Serialization.JavaScriptSerializer.deserialize(e);
this.fromData(d);
},fromData:function(d){if(d.name==this.get_name()){this._opacity=d.value;
}},canUndo:function(){return this._canUndo;
},get_name:function(){return"Opacity";
},get_text:function(){return this.get_name()+" "+this.get_currentOpacity()+"%";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_currentOpacity:function(){return this._opacity;
},set_currentOpacity:function(d){this._opacity=d;
},get_originalOpacity:function(){return this._prevOpacity;
},_updateImage:function(e,d){if(d&&(typeof(this._prevOpacity)=="undefined")||this._prevOpacity==null){this._prevOpacity=this._editableImage.get_opacity();
}this._editableImage._setOpacity(e);
}};
b.OpacityOperation.registerClass("Telerik.Web.UI.ImageEditor.OpacityOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.ResizeExtenderScroller=function(d,e){this._resizeExtender=d;
this.element=this._resizeExtender._element;
this.setOptions(e);
};
b.ResizeExtenderScroller.prototype={get_constraints:function(){return this.options.constraints;
},set_constraints:function(d){this.options.constraints=d;
},setOptions:function(d){this.options=c.extend({scrollEdgeConstSmall:20,scrollEdgeConst:30,scrollSpeed:2,constraints:null},d||{});
},startScrolling:function(){this._scrollTimer=new Telerik.Web.Timer();
this._scrollTimer.add_tick(Function.createDelegate(this,this._scrollViewport));
this._scrollTimer.set_interval(10);
},manageScrolling:function(){var f=c(this.element);
var d=f.position();
var e=f.parent();
this._scrollerX=this._calculateScrollDelta(d.left,f.width(),e.width(),e.scrollLeft());
this._scrollerY=this._calculateScrollDelta(d.top,f.height(),e.height(),e.scrollTop());
this._initScrolling();
},stopScrolling:function(){this._scrollTimer.dispose();
},add_scrolling:function(d){c(this).bind("scrolling",d);
},remove_scrolling:function(d){c(this).unbind("scrolling",d);
},raiseEvent:function(d,e){c(this).trigger(d,[e]);
},_scrollViewport:function(){var d=c(this.element);
var e=d.position();
var f=d.parent();
var i=this._getScrollPosition(f);
f.scrollLeft(i.left+this._scrollerX);
f.scrollTop(i.top+this._scrollerY);
var h=this._getScrollPosition(f);
var g=this._constrainPosition({x:e.left+h.left,y:e.top+h.top});
d.css({left:g.x,top:g.y});
this.raiseEvent("scrolling",{oldScroll:i,newScroll:h});
},_constrainPosition:function(e){var f=this.get_constraints();
if(f){var d=this.element;
e.x=Math.max(Math.min(e.x,f.horizontal-d.outerWidth()),0);
e.y=Math.max(Math.min(e.y,f.vertical-d.outerHeight()),0);
}return e;
},_initScrolling:function(){this._scrollTimer.set_enabled(this._scrollerX!=0||this._scrollerY!=0);
},_calculateScrollDelta:function(e,d,i,h){var f=this._resizeExtender._resizeDir;
var g=f.move||f.west||f.north;
if(g&&e<this.options.scrollEdgeConstSmall){return 0-this.options.scrollSpeed;
}else{if(e+d+this.options.scrollEdgeConst>i){return this.options.scrollSpeed;
}else{return 0;
}}},_getScrollPosition:function(d){return{left:d.scrollLeft(),top:d.scrollTop()};
},_getBorderDims:function(){return $telerik.getBorderBox(this._resizeExtender._element);
}};
b.ResizeExtenderScroller.registerClass("Telerik.Web.UI.ImageEditor.ResizeExtenderScroller");
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.ResizeOperation=function(f,e,d){b.ResizeOperation.initializeBase(this);
this._editableImage=f;
this._image=f?f.getImage():null;
this.set_size(e,d);
this._canUndo=false;
this._originalWidth=null;
this._originalHeight=null;
};
b.ResizeOperation.prototype={execute:function(){this.resize(this.get_width(),this.get_height());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this.resize(this.get_originalWidth(),this.get_originalHeight());
this._canUndo=false;
}},toString:function(e){var f=e?e._getWidth():this.get_width();
var d=e?e._getHeight():this.get_height();
return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),width:f,height:d,index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Resize";
},get_text:function(){return this.get_name()+" "+this.get_width()+"x"+this.get_height()+"px";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_width:function(){return this._width;
},get_originalWidth:function(){return this._originalWidth;
},get_height:function(){return this._height;
},get_originalHeight:function(){return this._originalHeight;
},set_size:function(d,e){d=this.parseSize(d);
this._width=isNaN(d)?"":d;
e=this.parseSize(e);
this._height=isNaN(e)?"":e;
},resize:function(d,e){this._updateImage(d,e);
},_updateImage:function(e,d){var f=this.get_editableImage();
this._originalWidth=f.get_width();
this._originalHeight=f.get_height();
if(e==""){e=this._originalWidth;
}if(d==""){d=this._originalHeight;
}if(e!=this._originalWidth||d!=this._originalHeight){f._setSize(e,d);
}},parseSize:function(d){return parseInt(d);
}};
b.ResizeOperation.registerClass("Telerik.Web.UI.ImageEditor.ResizeOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(c,a,b){b.RotateOperation=function(e,d,f){b.RotateOperation.initializeBase(this);
this._editableImage=e;
this._image=e?e.getImage():null;
this.set_rotation(d,f);
this._canUndo=false;
};
b.RotateOperation.prototype={execute:function(){this.rotate(this.get_rotationAngle());
this._canUndo=true;
},undo:function(){if(this.canUndo()){this.rotate(this.get_originalRotationAngle());
this._canUndo=false;
}},toString:function(){return Sys.Serialization.JavaScriptSerializer.serialize({name:this.get_name(),degree:this.get_rotationAngle(),index:this.get_index()});
},fromString:function(d){},fromData:function(d){},canUndo:function(){return this._canUndo;
},get_name:function(){return"Rotate";
},get_text:function(){return this.get_name()+" "+this.get_rotationAngle()+" deg";
},get_image:function(){return this._image;
},dispose:function(){delete this._canUndo;
delete this._image;
},get_editableImage:function(){return this._editableImage;
},get_rotationAngle:function(){return this._rotationAngle;
},get_originalRotationAngle:function(){return this._prevRotationAngle;
},get_rotation:function(){return this._rotation;
},set_rotation:function(e,d){if(e!=null&&typeof(e)!="undefined"){this._rotation=e;
this._rotationAngle=this._getAngleFromRotation(e);
return;
}else{if(d!=null&&typeof(d)!="undefined"){if(d!=0&&d!=90&&d!=180&&d!=270){d=0;
}this._rotationAngle=d;
return;
}}this._rotationAngle=0;
this._rotation=null;
},rotate:function(d){this._prevRotationAngle=this.get_editableImage().get_rotationAngle();
this._updateImage(d);
},_updateImage:function(d){this.get_editableImage()._setRotationAngle(d);
},_getAngleFromRotation:function(e){var d;
switch(e){case b.Rotation.Rotate90:d=90;
break;
case b.Rotation.Rotate180:d=180;
break;
case b.Rotation.Rotate270:d=270;
break;
default:d=0;
}return d;
}};
b.RotateOperation.registerClass("Telerik.Web.UI.ImageEditor.RotateOperation",b.ImageOperation,b.IImageOperation);
})($telerik.$,Telerik.Web.UI,Telerik.Web.UI.ImageEditor);
Type.registerNamespace("Telerik.Web.UI.ImageEditor");
(function(b,a){a.IToolWidget=function(){};
a.IToolWidget.prototype={updateUI:function(){},get_name:function(){},onOpen:function(){},onClose:function(){}};
a.IToolWidget.registerInterface("Telerik.Web.UI.ImageEditor.IToolWidget");
a.ToolWidget=function(c){this._imageEditor=c;
this._parentId="";
this.initialize();
};
a.ToolWidget.prototype={initialize:function(){},dispose:function(){window[this._imageEditor.get_id()+"_dockTitle"]=null;
},onOpen:function(){},onClose:function(){},close:function(){this.get_imageEditor().closeToolsPanel();
},get_imageEditor:function(){return this._imageEditor;
},set_imageEditor:function(c){this._imageEditor=c;
},get_image:function(){return this.get_imageEditor().getImage();
},get_parentId:function(){if(!this._parentId){this._parentId=this.get_imageEditor().get_id()+"_ToolsPanel_C_";
}return this._parentId;
},get_text:function(){var c=window[this._imageEditor.get_id()+"_dockTitle"];
return c?c:this.get_name();
},incrementValue:function(d,f,c){var e=parseInt(d.value);
if(c!=null&&typeof(c)!="undefined"){e=e+c;
}else{e++;
}if(e<=f){d.value=e;
return true;
}return false;
},decrementValue:function(e,c,f){var d=parseInt(e.value);
if(f!=null&&typeof(f)!="undefined"){d=d-f;
}else{d--;
}if(d>=c){e.value=d;
return true;
}return false;
},checkValue:function(e,d,g,c){var f=parseInt(e.value);
if(!isNaN(f)&&f<=g&&f>=d){if(!c){e.value=f;
}return f;
}return false;
},isNumeric:function(c){return((c>95&&c<107)||(c>47&&c<59));
},isBackspaceOrDelete:function(c){return(c==8||c==127);
},_getControlFromParent:function(c){return $get(this._getChildId(c));
},_findControlFromParent:function(c){return $find(this._getChildId(c));
},_getChildId:function(c){return this.get_parentId()+c;
}};
a.ToolWidget.registerClass("Telerik.Web.UI.ImageEditor.ToolWidget",null);
})($telerik.$,Telerik.Web.UI.ImageEditor);
